

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Trip Itinerary Planning &#8212; AI Search Algorithms for Smart Mobility</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script src="../../../_static/tabs.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/PeopleMobilityProblems/trip_itinerary_planning/TIP';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Multi-Criteria Routing" href="../multicriteriarouting/MultiCriteriaRouting.html" />
    <link rel="prev" title="Car-Sharing Service" href="../carsharing/CarSharing.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/sm.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../../_static/sm.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../index.html">
                    AI Search Algorithms for Smart Mobility - ECE1724
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../GettingStarted/index.html">Getting Started</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../IntroGeoScience/index.html">Introduction to Geospatial Data Science</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../IntroGeoScience/SpatialData.html">Spatial Data and Geographic Information System (GIS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../IntroGeoScience/Projection.html">Projection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../IntroGeoScience/Visualization.html">Visualization</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../GraphSearchAlgorithms/index.html">Graph Search Algorithms</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../GraphSearchAlgorithms/RoadGraph.html">From Road Network to Graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../GraphSearchAlgorithms/GraphSearch.html">Graph Search</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../GraphSearchAlgorithms/BlindSearch.html">Blind Search Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../GraphSearchAlgorithms/InformedSearch.html">Informed Search Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../GraphSearchAlgorithms/SearchComparison.html">Search Algorithm Comparison</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../TrajectoryAlgorithms/index.html">Trajectory-based Algorithms</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../TrajectoryAlgorithms/TabuSearch.html">Tabu Search</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../TrajectoryAlgorithms/SimulatedAnnealing.html">Simulated Annealing</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../EvolutionaryComputingAlgorithms/index.html">Evolutionary Computing Algorithms</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../EvolutionaryComputingAlgorithms/GeneratingInitialPopulations.html">Generating Initial Populations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../EvolutionaryComputingAlgorithms/GeneticAlgorithms.html">Genetic Algorithms</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../SwarmIntelligenceAlgorithms/index.html">Swarm Intelligence Algorithms</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../SwarmIntelligenceAlgorithms/ParticleSwarmOptimization.html">Particle Swarm Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../SwarmIntelligenceAlgorithms/AntColonyOptimization.html">Ant Colony Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../SwarmIntelligenceAlgorithms/ArtificialBeeColony.html">Artificial Bee Colony</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../SwarmIntelligenceAlgorithms/FireflyAlgorithm.html">Firefly Algorithm</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../LearnToSearch/index.html">Learn to Search</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../LearnToSearch/GeometricDeepLearning.html">Geometric Deep Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../LearnToSearch/GraphNeuralNetworks.html">Graph Neural Networks (GNN)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../LearnToSearch/AttentionMechanisms.html">Attention Mechanisms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../LearnToSearch/ReinforcementLearning.html">Reinforcement Learning</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../index.html">People Mobility Problems</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../carsharing/CarSharing.html">Car-Sharing Service</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Trip Itinerary Planning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../multicriteriarouting/MultiCriteriaRouting.html">Multi-Criteria Routing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deadheading/Deadheading.html">Deadheading in Ride-Hailing</a></li>

</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../LogisticsProblems/index.html">Logistics Problems</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../LogisticsProblems/delivery_GA.html">Delivery Vehicle Routing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../LogisticsProblems/eco_routing.html">Eco-efficient Delivery</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../InfrastructureProblems/index.html">Infrastructure Problems</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../InfrastructureProblems/emergency_vehicle/emergency_vehicle.html">Emergency Dispatch and Routing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../ToolsAndPythonLibraries/index.html">Tools and Python Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Datasets.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../References.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/SmartMobilityAlgorithms/book" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/content/PeopleMobilityProblems/trip_itinerary_planning/TIP.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Trip Itinerary Planning</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset">Dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-formulation">Problem Formulation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variables">Variables</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#objective">Objective</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#constraints">Constraints</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-object">Data Object</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-class">Problem Class</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ga-solver">GA Solver</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adaptive-ga-solver">Adaptive GA Solver</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#abc-solver">ABC Solver</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-the-problem">Solving the Problem</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ga-solution">GA Solution</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-results">Visualizing Results</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adaptive-ga-solution">Adaptive GA Solution</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Visualizing Results</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abc-solution">ABC Solution</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Visualizing Results</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparative-analysis">Comparative Analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Visualizing Results</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="trip-itinerary-planning">
<h1>Trip Itinerary Planning<a class="headerlink" href="#trip-itinerary-planning" title="Permalink to this heading">#</a></h1>
<p><strong>Authors:</strong> Jingkai Jia, Yuli Chen and Yuxuan Liu<br>
<strong>Course:</strong> ECE1724H: Bio-inspired Algorithms for Smart Mobility - Fall 2021<br>
<strong>Instructor:</strong> Dr. Alaa Khamis<br>
<strong>Department:</strong> Edward S. Rogers Sr. Department of Electrical &amp; Computer Engineering, University of Toronto</p>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p>The Trip Itinerary Problem (TIP) consists of a problem where a list of locations to visit must be selected, and have routes formulated between them, such that some sort of cost function (such as number of visited places, POI ranking, traveller satisfaction, etc) is maximized. <br></p>
<p>Essentially, the problem can be broken down into the following:</p>
<ol class="arabic simple">
<li><p>Select a subset from a set of POIs (or candidate points).</p></li>
<li><p>Construct one or more routes between a home point (like a hotel, etc.) and those points, in order to satisfy time and distance constraints.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ipyleaflet</span> <span class="kn">import</span> <span class="n">AntPath</span><span class="p">,</span><span class="n">Map</span><span class="p">,</span><span class="n">Marker</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">HTML</span>
<span class="kn">import</span> <span class="nn">osmnx</span> <span class="k">as</span> <span class="nn">ox</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">folium</span>
<span class="kn">import</span> <span class="nn">folium.plugins</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">combinations</span>
<span class="kn">from</span> <span class="nn">smart_mobility_utilities.poi</span> <span class="kn">import</span> <span class="n">number_DivIcon</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="nn">Input In [1],</span> in <span class="ni">&lt;cell line: 17&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span> <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="g g-Whitespace">     </span><span class="mi">16</span> <span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">combinations</span>
<span class="ne">---&gt; </span><span class="mi">17</span> <span class="kn">from</span> <span class="nn">smart_mobility_utilities.poi</span> <span class="kn">import</span> <span class="n">number_DivIcon</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;smart_mobility_utilities&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="dataset">
<h2>Dataset<a class="headerlink" href="#dataset" title="Permalink to this heading">#</a></h2>
<p>This implementation uses a dataset compiled from a <a class="reference external" href="https://ckan0.cf.opendata.inter.prod-toronto.ca/tr/dataset/places-of-interest-and-toronto-attractions">public source listing POIs and Attractions in Toronto</a>, supplemented with further data from mapping APIs such as Google Maps API.</p>
<p>A total of 165 POIs exist in the dataset.</p>
<p>Additionally, a precomputed matrix of distances between POIs was created in order eliminate the need for real-time distance queries and speed up the algorithm running times.</p>
</section>
<section id="problem-formulation">
<h2>Problem Formulation<a class="headerlink" href="#problem-formulation" title="Permalink to this heading">#</a></h2>
<section id="variables">
<h3>Variables<a class="headerlink" href="#variables" title="Permalink to this heading">#</a></h3>
<p><span class="math notranslate nohighlight">\(V_i\)</span> : poi i<br>
<span class="math notranslate nohighlight">\(R_i\)</span> : rating of <span class="math notranslate nohighlight">\(V_i\)</span><br>
<span class="math notranslate nohighlight">\(C_{ij}\)</span> : the time it takes for the user to travel from <span class="math notranslate nohighlight">\(V_i\)</span> to <span class="math notranslate nohighlight">\(V_j\)</span><br>
<span class="math notranslate nohighlight">\(L_{ij}\)</span> : the distance between <span class="math notranslate nohighlight">\(V_i\)</span> and <span class="math notranslate nohighlight">\(V_j\)</span><br>
<span class="math notranslate nohighlight">\(O_i,E_i\)</span> : the openning/closing time of <span class="math notranslate nohighlight">\(V_i\)</span><br>
<span class="math notranslate nohighlight">\(D_i\)</span> : duration visitor want to spend on <span class="math notranslate nohighlight">\(V_i\)</span><br>
<span class="math notranslate nohighlight">\(S_i\)</span> : the time when the visitor arrives <span class="math notranslate nohighlight">\(V_i\)</span><br>
<span class="math notranslate nohighlight">\(a_{ijk}\)</span> : whether <span class="math notranslate nohighlight">\(V_j\)</span> is visited after <span class="math notranslate nohighlight">\(V_i\)</span> in tour <span class="math notranslate nohighlight">\(k\)</span>. True -&gt; 1, False -&gt; 0<br>
<span class="math notranslate nohighlight">\(b_{ij}\)</span> : whether <span class="math notranslate nohighlight">\(V_i\)</span> is visited in tour <span class="math notranslate nohighlight">\(j\)</span>. True -&gt; 1, False -&gt; 0<br>
<span class="math notranslate nohighlight">\(m\)</span> : the number of tours a visitor wants to take<br>
<span class="math notranslate nohighlight">\(\gamma\)</span> : weight of soft constraint<br>
<span class="math notranslate nohighlight">\( T_{start}, T_{end}\)</span> : start and end time of the tour<br>
<span class="math notranslate nohighlight">\(Q\)</span> : a large positive constant used for integer programming modelling</p>
</section>
<section id="objective">
<h3>Objective<a class="headerlink" href="#objective" title="Permalink to this heading">#</a></h3>
<p><span class="math notranslate nohighlight">\(\sum_{i=0}^{m} \sum_{j=1}^{n} R_i b_{ij} - \sum_{i=1}^{n} \sum_{j=1}^{n}  \sum_{k=1}^{m} \gamma L_{ij} a_{ijk}\)</span></p>
</section>
<section id="constraints">
<h3>Constraints<a class="headerlink" href="#constraints" title="Permalink to this heading">#</a></h3>
<p><span class="math notranslate nohighlight">\(\sum_{i=0}^{m} \sum_{j=1}^{n} a_{1ij} = \sum_{i=0}^{m} \sum_{j=1}^{n} a_{nij} = m\)</span> (m tours are start from V1
and end with Vn)</p>
<p><span class="math notranslate nohighlight">\(\sum_{i=2}^{n-1} \sum_{j=1}^{m} b_{ij} \le 1\)</span> (all vertices
are visited only once)</p>
<p><span class="math notranslate nohighlight">\(\sum_{i=1}^{n-1} a_{ijk} = b_{kj}, k=2,...,n-1; j=1,...,m\)</span> (all tours are connected, used together with the constraint below)</p>
<p><span class="math notranslate nohighlight">\(\sum_{i=2}^{n} a_{ijk} = b_{kj}, k=2,...,n-1; j=1,...,m\)</span> (all tours are connected, used together with the constraint above)</p>
<p><span class="math notranslate nohighlight">\(S_{ik} + D_{i} + C_{ij} - S_{jk} \le Q(1-a_{ijk}), \&gt; i=1,...,n-1;j = 2,... n; k = 1,...,m\)</span> (travel time is continuous)</p>
<p><span class="math notranslate nohighlight">\(O_{i} \le S_{ij} + D_{i} \le E_{i}, \&gt; i = 1,...,n; j = 1,...,m\)</span> (vertices are visited within the time window)</p>
</section>
</section>
<section id="data-object">
<h2>Data Object<a class="headerlink" href="#data-object" title="Permalink to this heading">#</a></h2>
<p>The following class stores information about POIs, as well as loads POI distance information from the precomputed matrix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">POI</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">category</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lng</span><span class="p">,</span> <span class="n">rating</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">openings</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">category</span> <span class="o">=</span> <span class="n">category</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">=</span> <span class="p">(</span><span class="n">lat</span><span class="p">,</span><span class="n">lng</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">lng</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rating</span> <span class="o">=</span> <span class="n">rating</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visit_duration</span> <span class="o">=</span> <span class="mf">100.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">open_time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">close_time</span> <span class="o">=</span> <span class="n">openings</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">open_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_time</span> <span class="o">//</span> <span class="mi">100</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">open_time</span> <span class="o">%</span> <span class="mi">100</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">close_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">close_time</span> <span class="o">//</span> <span class="mi">100</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">close_time</span> <span class="o">%</span> <span class="mi">100</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BASE_DIR</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">route_cache</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_duration</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">warm_cache</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">warm_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">from_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">cache/poi_pair_cost_</span><span class="si">{}</span><span class="s1">.csv&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="n">from_id</span><span class="p">))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;cache/coords_db_</span><span class="si">{}</span><span class="s1">.json&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">from_id</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">coord_db</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
        
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;coords&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s1">&#39;length&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s1">&#39;duration&#39;</span><span class="p">:</span> <span class="kc">None</span>
            <span class="p">}</span>
            <span class="n">to_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;to_id&#39;</span><span class="p">])</span>
            <span class="n">result</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">60.0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">min_duration</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_duration</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">])</span>
            <span class="n">result</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">])</span>
            <span class="n">result</span><span class="p">[</span><span class="s1">&#39;coords&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">coord_db</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">from_id</span><span class="p">)][</span><span class="nb">str</span><span class="p">(</span><span class="n">to_id</span><span class="p">)]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">route_cache</span><span class="p">[(</span><span class="n">from_id</span><span class="p">,</span> <span class="n">to_id</span><span class="p">)]</span> <span class="o">=</span> <span class="n">result</span>
            
        
        
    <span class="k">def</span> <span class="nf">query_route_db</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">from_id</span><span class="p">,</span> <span class="n">to_id</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">from_id</span><span class="p">,</span> <span class="n">to_id</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">route_cache</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;coords&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s1">&#39;length&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
                <span class="s1">&#39;duration&#39;</span><span class="p">:</span> <span class="kc">None</span>
            <span class="p">}</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">cache/poi_pair_cost_</span><span class="si">{}</span><span class="s1">.csv&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BASE_DIR</span><span class="p">,</span> <span class="n">from_id</span><span class="p">))</span>
            
            <span class="n">result</span><span class="p">[</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">df</span><span class="p">[</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;to_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">to_id</span> <span class="p">][</span><span class="s1">&#39;duration&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mf">60.0</span>
            <span class="n">result</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">df</span><span class="p">[</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;to_id&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">to_id</span> <span class="p">][</span><span class="s1">&#39;length&#39;</span><span class="p">])</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;cache/coords_db_</span><span class="si">{}</span><span class="s1">.json&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">from_id</span><span class="p">))</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">result</span><span class="p">[</span><span class="s1">&#39;coords&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())[</span><span class="nb">str</span><span class="p">(</span><span class="n">from_id</span><span class="p">)][</span><span class="nb">str</span><span class="p">(</span><span class="n">to_id</span><span class="p">)]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">route_cache</span><span class="p">[(</span><span class="n">from_id</span><span class="p">,</span> <span class="n">to_id</span><span class="p">)]</span> <span class="o">=</span> <span class="n">result</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">route_cache</span><span class="p">[(</span><span class="n">from_id</span><span class="p">,</span> <span class="n">to_id</span><span class="p">)]</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">route_to</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">destination</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;driving&quot;</span><span class="p">):</span>
        <span class="n">from_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span>
        <span class="n">to_id</span> <span class="o">=</span> <span class="n">destination</span><span class="o">.</span><span class="n">id</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_route_db</span><span class="p">(</span><span class="n">from_id</span><span class="p">,</span> <span class="n">to_id</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">from_id</span><span class="p">,</span> <span class="n">to_id</span><span class="p">)</span>
            <span class="k">raise</span>
        <span class="k">return</span> <span class="n">result</span>
    
    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">id</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span>
    
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;ID: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">, Name: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">, Score: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rating</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="k">def</span> <span class="nf">get_pois</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="n">my_pois</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
        <span class="n">name</span><span class="p">,</span><span class="n">category</span><span class="p">,</span><span class="n">geoid</span><span class="p">,</span><span class="n">lat</span><span class="p">,</span><span class="n">lng</span><span class="p">,</span><span class="n">rating</span><span class="p">,</span><span class="n">openings</span><span class="p">,</span><span class="n">closings</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="n">poi</span> <span class="o">=</span> <span class="n">POI</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">category</span><span class="p">,</span> <span class="n">lng</span><span class="p">,</span> <span class="n">lat</span> <span class="p">,</span> <span class="n">rating</span><span class="p">,</span> <span class="p">(</span><span class="n">openings</span><span class="p">,</span> <span class="n">closings</span><span class="p">))</span>
        <span class="n">my_pois</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">poi</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">my_pois</span>


<span class="k">def</span> <span class="nf">getRouteBounds</span><span class="p">(</span><span class="n">tours</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">tour</span> <span class="ow">in</span> <span class="n">tours</span><span class="p">:</span>
        <span class="n">route</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">coordinates</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">t</span><span class="o">.</span><span class="n">coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tour</span><span class="p">]</span>
        <span class="n">minLat</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">route</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">maxLat</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">route</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">minLng</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">route</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">maxLng</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">route</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">[(</span><span class="n">minLat</span><span class="p">,</span> <span class="n">minLng</span><span class="p">),</span> <span class="p">(</span><span class="n">maxLat</span><span class="p">,</span> <span class="n">maxLng</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="problem-class">
<h2>Problem Class<a class="headerlink" href="#problem-class" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Problem</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_soft_constraint</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">number_of_tour</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pois</span> <span class="o">=</span> <span class="n">get_pois</span><span class="p">(</span><span class="s1">&#39;pois.csv&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">home_poi</span> <span class="o">=</span> <span class="n">POI</span><span class="p">(</span><span class="s1">&#39;Home&#39;</span><span class="p">,</span> <span class="mi">166</span><span class="p">,</span> <span class="s1">&#39;HOME&#39;</span><span class="p">,</span>  <span class="o">-</span><span class="mf">79.3969</span><span class="p">,</span> <span class="mf">43.6596</span><span class="p">,</span>  <span class="n">rating</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">openings</span><span class="o">=</span><span class="p">(</span><span class="mi">900</span><span class="p">,</span> <span class="mi">1700</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_tour</span> <span class="o">=</span> <span class="n">number_of_tour</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id_pois_map</span> <span class="o">=</span> <span class="p">{</span> <span class="n">poi</span><span class="o">.</span><span class="n">id</span><span class="p">:</span> <span class="n">poi</span> <span class="k">for</span> <span class="n">poi</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pois</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluation_cache</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_tour</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">id_pois_map</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="n">POI</span><span class="p">(</span><span class="s1">&#39;Spliter&#39;</span><span class="p">,</span> <span class="o">-</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;SPL&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span>  <span class="n">rating</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">openings</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_evaluation_cache</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># if use soft constraint, we apply some penalty to the evaluation function wrt the length driving</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_soft_constraint</span> <span class="o">=</span> <span class="n">use_soft_constraint</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">alpha</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_duration</span> <span class="o">=</span> <span class="p">[</span><span class="n">poi</span><span class="o">.</span><span class="n">min_duration</span> <span class="k">for</span> <span class="n">poi</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pois</span><span class="p">]</span>
        
    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">use_soft_constraint</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_soft_constraint</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span>
        <span class="n">number_of_tour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_tour</span>
        <span class="bp">self</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">use_soft_constraint</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">number_of_tour</span><span class="p">)</span>

    
    <span class="k">def</span> <span class="nf">navie_decode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gaint_tour</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        split a gaint tour into a list of single tour</span>
<span class="sd">        with out feasibility check</span>
<span class="sd">        </span>
<span class="sd">        example</span>
<span class="sd">        &gt;&gt; a = [1,3,-1,2,4]</span>
<span class="sd">        &gt;&gt; b = naive_decode(a)</span>
<span class="sd">        &gt;&gt; b # 5 is the id for home</span>
<span class="sd">        [ [5, 1, 3, 5],</span>
<span class="sd">          [5, 2, 4, 5] ]</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">solution</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">tour</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">gaint_tour</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">home_poi</span><span class="p">]</span> <span class="o">+</span> <span class="n">gaint_tour</span>
        <span class="k">for</span> <span class="n">poi</span> <span class="ow">in</span> <span class="n">gaint_tour</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">poi</span><span class="o">.</span><span class="n">id</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">tour</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">home_poi</span><span class="p">)</span>
                <span class="n">solution</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tour</span><span class="p">)</span>
                <span class="n">tour</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">home_poi</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tour</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">poi</span><span class="p">)</span>
        <span class="n">solution</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tour</span><span class="p">)</span>
        <span class="n">solution</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">home_poi</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">solution</span>
    
    <span class="k">def</span> <span class="nf">can_visit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_time</span><span class="p">,</span> <span class="n">current_poi</span><span class="p">,</span> <span class="n">next_poi</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">current_time</span> <span class="o">+</span> <span class="n">current_poi</span><span class="o">.</span><span class="n">route_to</span><span class="p">(</span><span class="n">next_poi</span><span class="p">)[</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">next_poi</span><span class="o">.</span><span class="n">visit_duration</span><span class="o">&gt;</span> <span class="n">next_poi</span><span class="o">.</span><span class="n">close_time</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">tentative_arrive_time</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">next_poi</span><span class="o">.</span><span class="n">open_time</span><span class="p">,</span> <span class="n">current_time</span> <span class="o">+</span> <span class="n">current_poi</span><span class="o">.</span><span class="n">route_to</span><span class="p">(</span><span class="n">next_poi</span><span class="p">)[</span><span class="s1">&#39;duration&#39;</span><span class="p">])</span>
        <span class="n">tentative_leave_time</span> <span class="o">=</span> <span class="n">tentative_arrive_time</span> <span class="o">+</span> <span class="n">next_poi</span><span class="o">.</span><span class="n">visit_duration</span>
        <span class="n">earliest_back_home_time</span> <span class="o">=</span> <span class="n">tentative_leave_time</span> <span class="o">+</span> <span class="n">next_poi</span><span class="o">.</span><span class="n">route_to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">home_poi</span><span class="p">)[</span><span class="s1">&#39;duration&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">earliest_back_home_time</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">home_poi</span><span class="o">.</span><span class="n">close_time</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>
    
    <span class="k">def</span> <span class="nf">filter_infeasible_pois</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tour</span><span class="p">):</span>
        <span class="n">current_time</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">feasible_tour</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">next_poi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tour</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">current_time</span> <span class="o">=</span> <span class="n">next_poi</span><span class="o">.</span><span class="n">open_time</span>
                <span class="n">current_poi</span> <span class="o">=</span> <span class="n">next_poi</span>
                <span class="n">feasible_tour</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_poi</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">next_poi</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">home_poi</span><span class="p">:</span>
                <span class="n">feasible_tour</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">home_poi</span><span class="p">)</span>
                <span class="k">break</span>
            
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">can_visit</span><span class="p">(</span><span class="n">current_time</span><span class="p">,</span> <span class="n">current_poi</span><span class="p">,</span> <span class="n">next_poi</span><span class="p">):</span>
                <span class="n">current_time</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">next_poi</span><span class="o">.</span><span class="n">open_time</span><span class="p">,</span> <span class="n">current_time</span> <span class="o">+</span> <span class="n">current_poi</span><span class="o">.</span><span class="n">route_to</span><span class="p">(</span><span class="n">next_poi</span><span class="p">)[</span><span class="s1">&#39;duration&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="n">next_poi</span><span class="o">.</span><span class="n">visit_duration</span>
                <span class="n">current_poi</span> <span class="o">=</span> <span class="n">next_poi</span>
                <span class="n">feasible_tour</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_poi</span><span class="p">)</span>            
        <span class="k">return</span> <span class="n">feasible_tour</span>
    
    <span class="k">def</span> <span class="nf">build_feasible_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solution</span><span class="p">):</span>
        <span class="n">feasible_soluion</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">tour</span> <span class="ow">in</span> <span class="n">solution</span><span class="p">:</span>

            <span class="n">feasible_tour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_infeasible_pois</span><span class="p">(</span><span class="n">tour</span><span class="p">)</span>
            <span class="n">feasible_soluion</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">feasible_tour</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">feasible_soluion</span>
        
            
    <span class="k">def</span> <span class="nf">gaint_tour_decode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gaint_tour</span><span class="p">):</span>
        <span class="n">infeasible_solution</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">navie_decode</span><span class="p">(</span><span class="n">gaint_tour</span><span class="p">)</span>
        <span class="n">feasible_solution</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_feasible_solution</span><span class="p">(</span><span class="n">infeasible_solution</span><span class="p">)</span>                
        <span class="k">return</span> <span class="n">feasible_solution</span>
                    
    
    <span class="k">def</span> <span class="nf">get_initial_soluton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;random&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;random&#39;</span><span class="p">:</span>
            <span class="n">gaint_tour</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">([</span><span class="n">poi</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">poi</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pois</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pois</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_tour</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">gaint_tour</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gaint_tour</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="o">-</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">gaint_tour</span>
    
    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gaint_tour</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_evaluation_cache</span> <span class="ow">and</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">gaint_tour</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation_cache</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation_cache</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">gaint_tour</span><span class="p">)]</span>
        <span class="n">gaint_poi_tour</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">id_pois_map</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">gaint_tour</span><span class="p">]</span>
        <span class="n">solution</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gaint_tour_decode</span><span class="p">(</span><span class="n">gaint_poi_tour</span><span class="p">)</span>
        <span class="n">score</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">tour</span> <span class="ow">in</span> <span class="n">solution</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">poi</span> <span class="ow">in</span> <span class="n">tour</span><span class="p">:</span>
                <span class="n">score</span> <span class="o">+=</span> <span class="n">poi</span><span class="o">.</span><span class="n">rating</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_soft_constraint</span><span class="p">:</span>
                <span class="n">score</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_tour_length</span><span class="p">(</span><span class="n">tour</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_evaluation_cache</span> <span class="ow">and</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">gaint_tour</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluation_cache</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">evaluation_cache</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">gaint_tour</span><span class="p">)]</span> <span class="o">=</span> <span class="n">score</span>
        <span class="k">return</span> <span class="n">score</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">draw_tours</span><span class="p">(</span><span class="n">tours</span><span class="p">):</span>
        <span class="n">center</span> <span class="o">=</span> <span class="p">[</span><span class="mf">43.6596</span><span class="p">,</span><span class="o">-</span><span class="mf">79.3969</span><span class="p">]</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">zoom_start</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
        <span class="n">bounds</span> <span class="o">=</span> <span class="n">getRouteBounds</span><span class="p">(</span><span class="n">tours</span><span class="p">)</span>
        <span class="n">m</span><span class="o">.</span><span class="n">fit_bounds</span><span class="p">(</span><span class="n">bounds</span><span class="p">)</span>
        <span class="n">color_set</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="s1">&#39;blue&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">tour</span> <span class="ow">in</span> <span class="n">tours</span><span class="p">:</span>
            <span class="n">tour_route</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">color</span> <span class="o">=</span> <span class="n">color_set</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">tour</span><span class="p">[</span><span class="mi">0</span><span class="p">:],</span><span class="n">tour</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">tour</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">folium</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">coordinates</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">icon</span><span class="o">=</span><span class="n">folium</span><span class="o">.</span><span class="n">Icon</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">icon_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">add_to</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
                <span class="n">folium</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">coordinates</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>  <span class="n">icon</span><span class="o">=</span><span class="n">number_DivIcon</span><span class="p">(</span><span class="n">color</span><span class="p">,</span><span class="n">i</span><span class="p">))</span><span class="o">.</span><span class="n">add_to</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">route_to</span><span class="p">(</span><span class="n">v</span><span class="p">)[</span><span class="s1">&#39;coords&#39;</span><span class="p">]</span>
                <span class="n">tour_route</span> <span class="o">+=</span> <span class="n">r</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">ant_path</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">plugins</span><span class="o">.</span><span class="n">AntPath</span><span class="p">(</span>
                <span class="n">locations</span><span class="o">=</span><span class="p">[</span>
                    <span class="n">tour_route</span>
                <span class="p">],</span>
                <span class="n">dash_array</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
                <span class="n">delay</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">ant_path</span><span class="o">.</span><span class="n">add_to</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">m</span>
    
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_tour_length</span><span class="p">(</span><span class="n">tour</span><span class="p">):</span>
        <span class="n">length</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">tour</span><span class="p">[</span><span class="mi">0</span><span class="p">:],</span><span class="n">tour</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
            <span class="k">if</span> <span class="n">u</span> <span class="o">!=</span> <span class="n">v</span><span class="p">:</span>
                <span class="n">length</span> <span class="o">+=</span> <span class="n">u</span><span class="o">.</span><span class="n">route_to</span><span class="p">(</span><span class="n">v</span><span class="p">)[</span><span class="s1">&#39;length&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">length</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="ga-solver">
<h2>GA Solver<a class="headerlink" href="#ga-solver" title="Permalink to this heading">#</a></h2>
<p>A solution class for Genetic Algorithm</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">GeneticAlgorithmSolver</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">population_size</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">global_solution</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">global_score</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;-inf&#39;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">max_geneartions</span> <span class="o">=</span> <span class="mi">1000</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">population</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">population_size</span> <span class="o">=</span> <span class="n">population_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">problem</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutation_prob</span> <span class="o">=</span> <span class="mf">0.1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">crossover_prob</span> <span class="o">=</span> <span class="mf">0.7</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">adaptive</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">converge_threshold</span> <span class="o">=</span> <span class="mf">0.1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fitness_level</span> <span class="o">=</span> <span class="mf">1.0</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">score_history</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">converge_history</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">terminate_threshold</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;-inf&#39;</span><span class="p">)</span>
        
        
    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">population_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">population_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">population_size</span><span class="p">)</span>
        
        
        
    <span class="k">def</span> <span class="nf">update_global</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">score</span><span class="p">,</span> <span class="n">solution</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_score</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">global_solution</span> <span class="o">=</span> <span class="n">solution</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">global_score</span> <span class="o">=</span> <span class="n">score</span>
            
    
    <span class="k">def</span> <span class="nf">pmx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">kept_idx</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">start</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">)])</span>
        <span class="n">kept_val</span> <span class="o">=</span> <span class="p">{</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kept_idx</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kept_idx</span><span class="p">:</span>
            <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="n">kept_val</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">while</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">kept_idx</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="n">j</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>          
            <span class="n">c</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">c</span>
        
        
    <span class="k">def</span> <span class="nf">permutation_cross_over</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;pmx&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;pmx&#39;</span><span class="p">:</span>
            <span class="n">child</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pmx</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">child</span>
    
    <span class="k">def</span> <span class="nf">mutate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">individual</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">adaptive</span><span class="p">:</span>
            <span class="n">mutation_prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mutation_prob</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fitness_level</span> <span class="o">+</span> <span class="mf">1e-2</span><span class="p">)</span> <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mutation_prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mutation_prob</span>
            
        <span class="k">if</span> <span class="n">mutation_prob</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="nb">int</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fitness_level</span> <span class="o">+</span> <span class="mf">1e-2</span><span class="p">)</span> <span class="p">)</span> <span class="p">):</span>
                <span class="n">idx</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">individual</span><span class="p">))</span>
                <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">individual</span><span class="p">[</span><span class="n">c1</span><span class="p">],</span> <span class="n">individual</span><span class="p">[</span><span class="n">c2</span><span class="p">]</span> <span class="o">=</span> <span class="n">individual</span><span class="p">[</span><span class="n">c2</span><span class="p">],</span> <span class="n">individual</span><span class="p">[</span><span class="n">c1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">individual</span>
        
        
    <span class="k">def</span> <span class="nf">generate_next</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">population</span><span class="p">):</span>
        <span class="n">next_generation</span> <span class="o">=</span> <span class="n">population</span><span class="p">[:]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">population</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">crossover_prob</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">():</span>
                <span class="n">parent_a</span> <span class="o">=</span> <span class="n">population</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">population</span><span class="p">)))</span>
                <span class="n">parent_b</span> <span class="o">=</span> <span class="n">population</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">population</span><span class="p">)))</span>
                <span class="n">child</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">permutation_cross_over</span><span class="p">(</span><span class="n">parent_a</span><span class="p">,</span> <span class="n">parent_b</span><span class="p">)</span>
                <span class="n">child</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mutate</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
                <span class="n">next_generation</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">next_generation</span>
    
    <span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">population</span><span class="p">):</span>
        <span class="n">score_board</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">individual</span> <span class="ow">in</span> <span class="n">population</span><span class="p">:</span>
            <span class="n">score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">individual</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_global</span><span class="p">(</span><span class="n">score</span><span class="p">,</span> <span class="n">individual</span><span class="p">)</span>
            <span class="n">score_board</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">[</span><span class="n">score</span><span class="p">,</span> <span class="n">individual</span><span class="p">]</span> <span class="p">)</span>
        <span class="n">score_board</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">score_board</span><span class="p">]</span>
        <span class="n">score_board</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">score_board</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">converge_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">scores</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">population_size</span><span class="p">]))</span>

        <span class="n">next_gen</span> <span class="o">=</span> <span class="n">score_board</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">population_size</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">adaptive</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">converge_threshold</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">population_size</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">population_size</span><span class="p">):</span>
                <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">next_gen</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">adaptive</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fitness_level</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">next_gen</span>
                
    <span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">problem</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">problem</span> <span class="o">=</span> <span class="n">problem</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">population_size</span><span class="p">):</span>
            <span class="n">individual</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_initial_soluton</span><span class="p">()</span>
            <span class="n">score</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">individual</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_global</span><span class="p">(</span> <span class="n">score</span><span class="p">,</span> <span class="n">individual</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">individual</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">geneartion</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_geneartions</span><span class="p">)):</span>
            <span class="n">next_population_candidates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">population</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">population</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">next_population_candidates</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">score_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_score</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">geneartion</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="adaptive-ga-solver">
<h2>Adaptive GA Solver<a class="headerlink" href="#adaptive-ga-solver" title="Permalink to this heading">#</a></h2>
<p>Adaptive variant of GA Solver</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">class</span> <span class="nc">AdaptiveGeneticAlgorithmSolver</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">population_size</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">global_solution</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">global_score</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;-inf&#39;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">max_geneartions</span> <span class="o">=</span> <span class="mi">1000</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">population</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">population_size</span> <span class="o">=</span> <span class="n">population_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">problem</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mutation_prob</span> <span class="o">=</span> <span class="mf">0.1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">crossover_prob</span> <span class="o">=</span> <span class="mf">0.7</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">adaptive</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">converge_threshold</span> <span class="o">=</span> <span class="mf">0.1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fitness_level</span> <span class="o">=</span> <span class="mf">1.0</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">score_history</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">converge_history</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">terminate_threshold</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;-inf&#39;</span><span class="p">)</span>
        
        
    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">population_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">population_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">population_size</span><span class="p">)</span>
        
        
        
    <span class="k">def</span> <span class="nf">update_global</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">score</span><span class="p">,</span> <span class="n">solution</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_score</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">global_solution</span> <span class="o">=</span> <span class="n">solution</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">global_score</span> <span class="o">=</span> <span class="n">score</span>
            
    
    <span class="k">def</span> <span class="nf">pmx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">kept_idx</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">start</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span><span class="p">)])</span>
        <span class="n">kept_val</span> <span class="o">=</span> <span class="p">{</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kept_idx</span><span class="p">}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kept_idx</span><span class="p">:</span>
            <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="n">kept_val</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">while</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">kept_idx</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="n">j</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>          
            <span class="n">c</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">c</span>
        
        
    <span class="k">def</span> <span class="nf">permutation_cross_over</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;pmx&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;pmx&#39;</span><span class="p">:</span>
            <span class="n">child</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pmx</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">child</span>
    
    <span class="k">def</span> <span class="nf">mutate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">individual</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">adaptive</span><span class="p">:</span>
            <span class="n">mutation_prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mutation_prob</span> <span class="o">*</span> <span class="p">(</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fitness_level</span> <span class="o">+</span> <span class="mf">1e-2</span><span class="p">)</span> <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mutation_prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mutation_prob</span>
            
        <span class="k">if</span> <span class="n">mutation_prob</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="nb">int</span><span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fitness_level</span> <span class="o">+</span> <span class="mf">1e-2</span><span class="p">)</span> <span class="p">)</span> <span class="p">):</span>
                <span class="n">idx</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">individual</span><span class="p">))</span>
                <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">individual</span><span class="p">[</span><span class="n">c1</span><span class="p">],</span> <span class="n">individual</span><span class="p">[</span><span class="n">c2</span><span class="p">]</span> <span class="o">=</span> <span class="n">individual</span><span class="p">[</span><span class="n">c2</span><span class="p">],</span> <span class="n">individual</span><span class="p">[</span><span class="n">c1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">individual</span>
        
        
    <span class="k">def</span> <span class="nf">generate_next</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">population</span><span class="p">):</span>
        <span class="n">next_generation</span> <span class="o">=</span> <span class="n">population</span><span class="p">[:]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">population</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">crossover_prob</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">():</span>
                <span class="n">parent_a</span> <span class="o">=</span> <span class="n">population</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">population</span><span class="p">)))</span>
                <span class="n">parent_b</span> <span class="o">=</span> <span class="n">population</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">population</span><span class="p">)))</span>
                <span class="n">child</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">permutation_cross_over</span><span class="p">(</span><span class="n">parent_a</span><span class="p">,</span> <span class="n">parent_b</span><span class="p">)</span>
                <span class="n">child</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mutate</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
                <span class="n">next_generation</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">next_generation</span>
    
    <span class="k">def</span> <span class="nf">select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">population</span><span class="p">):</span>
        <span class="n">score_board</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">individual</span> <span class="ow">in</span> <span class="n">population</span><span class="p">:</span>
            <span class="n">score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">individual</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_global</span><span class="p">(</span><span class="n">score</span><span class="p">,</span> <span class="n">individual</span><span class="p">)</span>
            <span class="n">score_board</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">[</span><span class="n">score</span><span class="p">,</span> <span class="n">individual</span><span class="p">]</span> <span class="p">)</span>
        <span class="n">score_board</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">score_board</span><span class="p">]</span>
        <span class="n">score_board</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">score_board</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">converge_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">scores</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">population_size</span><span class="p">]))</span>
        <span class="n">next_gen</span> <span class="o">=</span> <span class="n">score_board</span><span class="p">[:</span><span class="bp">self</span><span class="o">.</span><span class="n">population_size</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">adaptive</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">converge_threshold</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">population_size</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">population_size</span><span class="p">):</span>
                <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">next_gen</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">adaptive</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fitness_level</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">next_gen</span>
                
    <span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">problem</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">problem</span> <span class="o">=</span> <span class="n">problem</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">population_size</span><span class="p">):</span>
            <span class="n">individual</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_initial_soluton</span><span class="p">()</span>
            <span class="n">score</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">individual</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_global</span><span class="p">(</span> <span class="n">score</span><span class="p">,</span> <span class="n">individual</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">population</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">individual</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">geneartion</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_geneartions</span><span class="p">)):</span>
            <span class="n">next_population_candidates</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">population</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">population</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">next_population_candidates</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">score_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_score</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">geneartion</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="abc-solver">
<h2>ABC Solver<a class="headerlink" href="#abc-solver" title="Permalink to this heading">#</a></h2>
<p>Solution class for Artificial Bee Colony Solver</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">AritificalBeeColonySolver</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">population_size</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">global_solution</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">global_score</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;-inf&#39;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span> <span class="o">=</span> <span class="mi">1000</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_of_bees</span> <span class="o">=</span> <span class="n">population_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">food_sources</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">food_source_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_of_bees</span> <span class="o">//</span> <span class="mi">2</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">improvement_histories</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">problem</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pairs</span> <span class="o">=</span> <span class="kc">None</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">score_history</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">converge_history</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">terminate_threshold</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;-inf&#39;</span><span class="p">)</span>
        
        
    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">population_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_of_bees</span>
        <span class="bp">self</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">population_size</span><span class="p">)</span>
        
        
    <span class="k">def</span> <span class="nf">update_global</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">score</span><span class="p">,</span> <span class="n">solution</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_score</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">global_solution</span> <span class="o">=</span> <span class="n">solution</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">global_score</span> <span class="o">=</span> <span class="n">score</span>
      
    <span class="k">def</span> <span class="nf">move_around</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">source</span><span class="p">)),</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">source</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">source</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">source</span>
    
    <span class="k">def</span> <span class="nf">employ_bee_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_id</span><span class="p">):</span>
        <span class="n">source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">food_sources</span><span class="p">[</span><span class="n">source_id</span><span class="p">]</span>
        <span class="n">neighbour</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">move_around</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">neighbour</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">improvement_histories</span><span class="p">[</span><span class="n">source_id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">neighbour</span>
        <span class="k">return</span> <span class="n">source</span>
    
    <span class="k">def</span> <span class="nf">get_abandoned</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">abandoned</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">improvement_history</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">improvement_histories</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">improvement_history</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">improvement_history</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:])</span> <span class="o">/</span> <span class="mi">10</span> <span class="o">&lt;=</span> <span class="mf">0.4</span><span class="p">:</span>
                    <span class="n">abandoned</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">abandoned</span>
    
    <span class="k">def</span> <span class="nf">scout_bee_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_id</span><span class="p">):</span>
        <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">food_sources</span><span class="p">[</span><span class="n">source_id</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">food_sources</span><span class="p">[</span><span class="n">source_id</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">improvement_histories</span><span class="p">[</span><span class="n">source_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="kc">True</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">food_sources</span><span class="p">[</span><span class="n">source_id</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">solution</span><span class="p">):</span>
        <span class="n">score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">solution</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_global</span><span class="p">(</span><span class="n">score</span><span class="p">,</span> <span class="n">solution</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">score</span>
                    
                
    <span class="k">def</span> <span class="nf">solve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">problem</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">problem</span> <span class="o">=</span> <span class="n">problem</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">food_source_size</span><span class="p">):</span>
            <span class="n">food_source</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">get_initial_soluton</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">food_source</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">food_sources</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">food_source</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">improvement_histories</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="kc">True</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_iterations</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_of_bees</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">food_sources</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">employ_bee_update</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                
            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_of_bees</span> <span class="o">//</span> <span class="mi">2</span><span class="p">):</span>
                <span class="n">scores</span> <span class="o">=</span> <span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">source</span><span class="p">)</span> <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">food_sources</span> <span class="p">]</span>
                <span class="n">distribution</span> <span class="o">=</span> <span class="p">[</span> <span class="n">s</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">scores</span> <span class="p">]</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">food_source_size</span><span class="p">),</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">distribution</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">food_sources</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">employ_bee_update</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">converge_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">scores</span><span class="p">))</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_abandoned</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">food_sources</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scout_bee_update</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">score_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">global_score</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">score_history</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">score_history</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:])</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">terminate_threshold</span><span class="p">:</span>
                    <span class="k">break</span>
        <span class="k">return</span> <span class="n">iteration</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="solving-the-problem">
<h2>Solving the Problem<a class="headerlink" href="#solving-the-problem" title="Permalink to this heading">#</a></h2>
<p>We can solve the problem using different algorithms and compare the results.</p>
<p>For this case, we will assume the following parameters:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">Problem</span><span class="p">(</span><span class="n">use_soft_constraint</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span> <span class="n">number_of_tour</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="ga-solution">
<h3>GA Solution<a class="headerlink" href="#ga-solution" title="Permalink to this heading">#</a></h3>
<p>This implementation seeks to produce two tours, using the Genetic Algorithm Solver.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># defaults are max_generations = 1000, population_size = 20</span>
<span class="n">ga</span> <span class="o">=</span> <span class="n">GeneticAlgorithmSolver</span><span class="p">()</span>
<span class="n">ga</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">gaint_tour_decode</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">id_pois_map</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ga</span><span class="o">.</span><span class="n">global_solution</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "fbdf80b60d224fc8b62a3f72961ffa22", "version_major": 2, "version_minor": 0}</script></div>
</div>
<section id="visualizing-results">
<h4>Visualizing Results<a class="headerlink" href="#visualizing-results" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Problem</span><span class="o">.</span><span class="n">draw_tours</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ipykernel_4124</span><span class="o">/</span><span class="mf">3014936520.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">Problem</span><span class="o">.</span><span class="n">draw_tours</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span>

<span class="nn">/tmp/ipykernel_4124/703988465.py</span> in <span class="ni">draw_tours</span><span class="nt">(tours)</span>
<span class="g g-Whitespace">    </span><span class="mi">128</span>                 <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">tour</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">129</span>                     <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="ne">--&gt; </span><span class="mi">130</span>                 <span class="n">folium</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">icon</span><span class="o">=</span><span class="n">folium</span><span class="o">.</span><span class="n">Icon</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">icon_color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">add_to</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">131</span>                 <span class="n">folium</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">coordinates</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>  <span class="n">icon</span><span class="o">=</span><span class="n">number_DivIcon</span><span class="p">(</span><span class="n">color</span><span class="p">,</span><span class="n">i</span><span class="p">))</span><span class="o">.</span><span class="n">add_to</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">132</span>                 <span class="n">r</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">route_to</span><span class="p">(</span><span class="n">v</span><span class="p">)[</span><span class="s1">&#39;coords&#39;</span><span class="p">]</span>

<span class="ne">NameError</span>: name &#39;loc&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">ga</span><span class="o">.</span><span class="n">converge_history</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))),</span><span class="n">data</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Convergence process of GA&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;iteration&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;pop. score&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The final solution has a score of&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">ga</span><span class="o">.</span><span class="n">global_score</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The final solution has a score of 38.348292
</pre></div>
</div>
<img alt="../../../_images/a3945c52d20a6c3d90623d6ae9c3a541ea8c94af1b29ba24ee1f52d6f70c1908.png" src="../../../_images/a3945c52d20a6c3d90623d6ae9c3a541ea8c94af1b29ba24ee1f52d6f70c1908.png" />
</div>
</div>
</section>
</section>
<section id="adaptive-ga-solution">
<h3>Adaptive GA Solution<a class="headerlink" href="#adaptive-ga-solution" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># defaults are max_generations = 1000, population_size = 20</span>
<span class="n">aga</span> <span class="o">=</span> <span class="n">AdaptiveGeneticAlgorithmSolver</span><span class="p">()</span>
<span class="n">aga</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">gaint_tour_decode</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">id_pois_map</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span>  <span class="n">aga</span><span class="o">.</span><span class="n">global_solution</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 1000/1000 [00:01&lt;00:00, 511.04it/s]
</pre></div>
</div>
</div>
</div>
<section id="id1">
<h4>Visualizing Results<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Problem</span><span class="o">.</span><span class="n">draw_tours</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div style="width:100%;"><div style="position:relative;width:100%;height:0;padding-bottom:60%;"><span style="color:#565656">Make this Notebook Trusted to load map: File -> Trust Notebook</span><iframe src="about:blank" style="position:absolute;width:100%;height:100%;left:0;top:0;border:none !important;" data-html=%3C%21DOCTYPE%20html%3E%0A%3Chead%3E%20%20%20%20%0A%20%20%20%20%3Cmeta%20http-equiv%3D%22content-type%22%20content%3D%22text/html%3B%20charset%3DUTF-8%22%20/%3E%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%3Cscript%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20L_NO_TOUCH%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20L_DISABLE_3D%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%3C/script%3E%0A%20%20%20%20%0A%20%20%20%20%3Cstyle%3Ehtml%2C%20body%20%7Bwidth%3A%20100%25%3Bheight%3A%20100%25%3Bmargin%3A%200%3Bpadding%3A%200%3B%7D%3C/style%3E%0A%20%20%20%20%3Cstyle%3E%23map%20%7Bposition%3Aabsolute%3Btop%3A0%3Bbottom%3A0%3Bright%3A0%3Bleft%3A0%3B%7D%3C/style%3E%0A%20%20%20%20%3Cscript%20src%3D%22https%3A//cdn.jsdelivr.net/npm/leaflet%401.6.0/dist/leaflet.js%22%3E%3C/script%3E%0A%20%20%20%20%3Cscript%20src%3D%22https%3A//code.jquery.com/jquery-1.12.4.min.js%22%3E%3C/script%3E%0A%20%20%20%20%3Cscript%20src%3D%22https%3A//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js%22%3E%3C/script%3E%0A%20%20%20%20%3Cscript%20src%3D%22https%3A//cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js%22%3E%3C/script%3E%0A%20%20%20%20%3Clink%20rel%3D%22stylesheet%22%20href%3D%22https%3A//cdn.jsdelivr.net/npm/leaflet%401.6.0/dist/leaflet.css%22/%3E%0A%20%20%20%20%3Clink%20rel%3D%22stylesheet%22%20href%3D%22https%3A//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css%22/%3E%0A%20%20%20%20%3Clink%20rel%3D%22stylesheet%22%20href%3D%22https%3A//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css%22/%3E%0A%20%20%20%20%3Clink%20rel%3D%22stylesheet%22%20href%3D%22https%3A//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css%22/%3E%0A%20%20%20%20%3Clink%20rel%3D%22stylesheet%22%20href%3D%22https%3A//cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css%22/%3E%0A%20%20%20%20%3Clink%20rel%3D%22stylesheet%22%20href%3D%22https%3A//cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css%22/%3E%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cmeta%20name%3D%22viewport%22%20content%3D%22width%3Ddevice-width%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20initial-scale%3D1.0%2C%20maximum-scale%3D1.0%2C%20user-scalable%3Dno%22%20/%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cstyle%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23map_c1bddb3b59fd4c87b379bca1fbd4d313%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20position%3A%20relative%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20width%3A%20100.0%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20height%3A%20100.0%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20left%3A%200.0%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20top%3A%200.0%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C/style%3E%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%3Cscript%20src%3D%22https%3A//cdn.jsdelivr.net/npm/leaflet-ant-path%401.1.2/dist/leaflet-ant-path.min.js%22%3E%3C/script%3E%0A%3C/head%3E%0A%3Cbody%3E%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22folium-map%22%20id%3D%22map_c1bddb3b59fd4c87b379bca1fbd4d313%22%20%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%0A%3C/body%3E%0A%3Cscript%3E%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20map_c1bddb3b59fd4c87b379bca1fbd4d313%20%3D%20L.map%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22map_c1bddb3b59fd4c87b379bca1fbd4d313%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20center%3A%20%5B0%2C%200%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20crs%3A%20L.CRS.EPSG3857%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20zoom%3A%201%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20zoomControl%3A%20true%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20preferCanvas%3A%20false%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%29%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20tile_layer_271b58c0a18b48ccbc08a9ad7fff0447%20%3D%20L.tileLayer%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22https%3A//%7Bs%7D.tile.openstreetmap.org/%7Bz%7D/%7Bx%7D/%7By%7D.png%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%22attribution%22%3A%20%22Data%20by%20%5Cu0026copy%3B%20%5Cu003ca%20href%3D%5C%22http%3A//openstreetmap.org%5C%22%5Cu003eOpenStreetMap%5Cu003c/a%5Cu003e%2C%20under%20%5Cu003ca%20href%3D%5C%22http%3A//www.openstreetmap.org/copyright%5C%22%5Cu003eODbL%5Cu003c/a%5Cu003e.%22%2C%20%22detectRetina%22%3A%20false%2C%20%22maxNativeZoom%22%3A%2018%2C%20%22maxZoom%22%3A%2018%2C%20%22minZoom%22%3A%200%2C%20%22noWrap%22%3A%20false%2C%20%22opacity%22%3A%201%2C%20%22subdomains%22%3A%20%22abc%22%2C%20%22tms%22%3A%20false%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%29.addTo%28map_c1bddb3b59fd4c87b379bca1fbd4d313%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20map_c1bddb3b59fd4c87b379bca1fbd4d313.fitBounds%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B%5B%5B43.6536066%2C%20-79.39251229999999%5D%2C%20%5B43.665581%2C%20-79.3971596%5D%5D%2C%20%5B%5B43.6864006%2C%20-79.3602927%5D%2C%20%5B43.6864006%2C%20-79.3602927%5D%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20marker_2783bda2e4514bb2ae80b867f2e7403c%20%3D%20L.marker%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B43.646771%2C%20-79.3853839%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%29.addTo%28map_c1bddb3b59fd4c87b379bca1fbd4d313%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20div_icon_3fc5c9c0ec3a4bc0b356263ecdc20794%20%3D%20L.divIcon%28%7B%22className%22%3A%20%22empty%22%2C%20%22html%22%3A%20%22%5Cu003cspan%20class%3D%5C%22fa-stack%20%5C%22%20style%3D%5C%22font-size%3A%2012pt%5C%22%20%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cspan%20class%3D%5C%22fa%20fa-circle-o%20fa-stack-2x%5C%22%20style%3D%5C%22color%20%3A%20blue%5C%22%5Cu003e%5Cu003c/span%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cstrong%20class%3D%5C%22fa-stack-1x%5C%22%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%201%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/strong%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/span%5Cu003e%22%2C%20%22iconAnchor%22%3A%20%5B12%2C%2040%5D%2C%20%22iconSize%22%3A%20%5B150%2C%2036%5D%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20marker_2783bda2e4514bb2ae80b867f2e7403c.setIcon%28div_icon_3fc5c9c0ec3a4bc0b356263ecdc20794%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20marker_4395514f86954064ad6fc027c37cdc75%20%3D%20L.marker%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B43.6621271%2C%20-79.402118%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%29.addTo%28map_c1bddb3b59fd4c87b379bca1fbd4d313%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20div_icon_5052373fe26241e2befce748d66f393f%20%3D%20L.divIcon%28%7B%22className%22%3A%20%22empty%22%2C%20%22html%22%3A%20%22%5Cu003cspan%20class%3D%5C%22fa-stack%20%5C%22%20style%3D%5C%22font-size%3A%2012pt%5C%22%20%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cspan%20class%3D%5C%22fa%20fa-circle-o%20fa-stack-2x%5C%22%20style%3D%5C%22color%20%3A%20blue%5C%22%5Cu003e%5Cu003c/span%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cstrong%20class%3D%5C%22fa-stack-1x%5C%22%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%202%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/strong%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/span%5Cu003e%22%2C%20%22iconAnchor%22%3A%20%5B12%2C%2040%5D%2C%20%22iconSize%22%3A%20%5B150%2C%2036%5D%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20marker_4395514f86954064ad6fc027c37cdc75.setIcon%28div_icon_5052373fe26241e2befce748d66f393f%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20marker_cd47443ec6e24d4698357ceeef67aa70%20%3D%20L.marker%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B43.6431207%2C%20-79.4232609%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%29.addTo%28map_c1bddb3b59fd4c87b379bca1fbd4d313%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20div_icon_ae67f808f0a3489d93c827fc8d3a7b48%20%3D%20L.divIcon%28%7B%22className%22%3A%20%22empty%22%2C%20%22html%22%3A%20%22%5Cu003cspan%20class%3D%5C%22fa-stack%20%5C%22%20style%3D%5C%22font-size%3A%2012pt%5C%22%20%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cspan%20class%3D%5C%22fa%20fa-circle-o%20fa-stack-2x%5C%22%20style%3D%5C%22color%20%3A%20blue%5C%22%5Cu003e%5Cu003c/span%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cstrong%20class%3D%5C%22fa-stack-1x%5C%22%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%203%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/strong%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/span%5Cu003e%22%2C%20%22iconAnchor%22%3A%20%5B12%2C%2040%5D%2C%20%22iconSize%22%3A%20%5B150%2C%2036%5D%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20marker_cd47443ec6e24d4698357ceeef67aa70.setIcon%28div_icon_ae67f808f0a3489d93c827fc8d3a7b48%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20marker_4718608e6a964c7798aca7d477641f93%20%3D%20L.marker%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B43.679786%2C%20-79.42392699999999%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%29.addTo%28map_c1bddb3b59fd4c87b379bca1fbd4d313%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20div_icon_cc49a1d6dcfa45b9931da6fe46858e2b%20%3D%20L.divIcon%28%7B%22className%22%3A%20%22empty%22%2C%20%22html%22%3A%20%22%5Cu003cspan%20class%3D%5C%22fa-stack%20%5C%22%20style%3D%5C%22font-size%3A%2012pt%5C%22%20%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cspan%20class%3D%5C%22fa%20fa-circle-o%20fa-stack-2x%5C%22%20style%3D%5C%22color%20%3A%20blue%5C%22%5Cu003e%5Cu003c/span%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cstrong%20class%3D%5C%22fa-stack-1x%5C%22%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%204%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/strong%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/span%5Cu003e%22%2C%20%22iconAnchor%22%3A%20%5B12%2C%2040%5D%2C%20%22iconSize%22%3A%20%5B150%2C%2036%5D%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20marker_4718608e6a964c7798aca7d477641f93.setIcon%28div_icon_cc49a1d6dcfa45b9931da6fe46858e2b%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20marker_9c10b742479d4907969f0fcc57636a1b%20%3D%20L.marker%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B43.6596%2C%20-79.3969%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%29.addTo%28map_c1bddb3b59fd4c87b379bca1fbd4d313%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20div_icon_efb5dd261e5e4800980fe2bd8a92d757%20%3D%20L.divIcon%28%7B%22className%22%3A%20%22empty%22%2C%20%22html%22%3A%20%22%5Cu003cspan%20class%3D%5C%22fa-stack%20%5C%22%20style%3D%5C%22font-size%3A%2012pt%5C%22%20%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cspan%20class%3D%5C%22fa%20fa-circle-o%20fa-stack-2x%5C%22%20style%3D%5C%22color%20%3A%20blue%5C%22%5Cu003e%5Cu003c/span%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cstrong%20class%3D%5C%22fa-stack-1x%5C%22%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%200%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/strong%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/span%5Cu003e%22%2C%20%22iconAnchor%22%3A%20%5B12%2C%2040%5D%2C%20%22iconSize%22%3A%20%5B150%2C%2036%5D%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20marker_9c10b742479d4907969f0fcc57636a1b.setIcon%28div_icon_efb5dd261e5e4800980fe2bd8a92d757%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20ant_path_b175e78a613a4e419803da8aadb412ec%20%3D%20L.polyline.antPath%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B%5B%5B43.65966%2C%20-79.3966%5D%2C%20%5B43.658696%2C%20-79.395985%5D%2C%20%5B43.659199%2C%20-79.393501%5D%2C%20%5B43.655799%2C%20-79.392053%5D%2C%20%5B43.656302%2C%20-79.389103%5D%2C%20%5B43.646388%2C%20-79.384086%5D%2C%20%5B43.646231%2C%20-79.384877%5D%2C%20%5B43.646828%2C%20-79.385135%5D%2C%20%5B43.646828%2C%20-79.385135%5D%2C%20%5B43.646231%2C%20-79.384877%5D%2C%20%5B43.644448%2C%20-79.393126%5D%2C%20%5B43.644443%2C%20-79.394493%5D%2C%20%5B43.659186%2C%20-79.400229%5D%2C%20%5B43.660312%2C%20-79.400603%5D%2C%20%5B43.663094%2C%20-79.401995%5D%2C%20%5B43.662181%2C%20-79.401858%5D%2C%20%5B43.662181%2C%20-79.401858%5D%2C%20%5B43.660207%2C%20-79.401216%5D%2C%20%5B43.659066%2C%20-79.400726%5D%2C%20%5B43.64873%2C%20-79.396467%5D%2C%20%5B43.643289%2C%20-79.423325%5D%2C%20%5B43.643289%2C%20-79.423325%5D%2C%20%5B43.644165%2C%20-79.418849%5D%2C%20%5B43.67006%2C%20-79.429012%5D%2C%20%5B43.671625%2C%20-79.421531%5D%2C%20%5B43.68001%2C%20-79.425036%5D%2C%20%5B43.680257%2C%20-79.424119%5D%2C%20%5B43.680257%2C%20-79.424119%5D%2C%20%5B43.680528%2C%20-79.42284%5D%2C%20%5B43.680858%2C%20-79.422963%5D%2C%20%5B43.681811%2C%20-79.418362%5D%2C%20%5B43.681558%2C%20-79.418041%5D%2C%20%5B43.681124%2C%20-79.417503%5D%2C%20%5B43.661528%2C%20-79.409753%5D%2C%20%5B43.663497%2C%20-79.400045%5D%2C%20%5B43.66008%2C%20-79.39868%5D%2C%20%5B43.660444%2C%20-79.396925%5D%2C%20%5B43.65966%2C%20-79.3966%5D%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%22bubblingMouseEvents%22%3A%20true%2C%20%22color%22%3A%20%22blue%22%2C%20%22dashArray%22%3A%20%5B1%2C%2010%5D%2C%20%22dashOffset%22%3A%20null%2C%20%22delay%22%3A%201000%2C%20%22fill%22%3A%20false%2C%20%22fillColor%22%3A%20%22blue%22%2C%20%22fillOpacity%22%3A%200.2%2C%20%22fillRule%22%3A%20%22evenodd%22%2C%20%22hardwareAcceleration%22%3A%20false%2C%20%22lineCap%22%3A%20%22round%22%2C%20%22lineJoin%22%3A%20%22round%22%2C%20%22noClip%22%3A%20false%2C%20%22opacity%22%3A%200.5%2C%20%22paused%22%3A%20false%2C%20%22pulseColor%22%3A%20%22%23FFFFFF%22%2C%20%22reverse%22%3A%20false%2C%20%22smoothFactor%22%3A%201.0%2C%20%22stroke%22%3A%20true%2C%20%22weight%22%3A%205%7D%0A%20%20%20%20%20%20%20%20%29.addTo%28map_c1bddb3b59fd4c87b379bca1fbd4d313%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20marker_65e7fae5e33b4fce964aeed2ae952d2e%20%3D%20L.marker%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B43.665581%2C%20-79.3971596%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%29.addTo%28map_c1bddb3b59fd4c87b379bca1fbd4d313%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20div_icon_a0772394217d4a2180c3596848035573%20%3D%20L.divIcon%28%7B%22className%22%3A%20%22empty%22%2C%20%22html%22%3A%20%22%5Cu003cspan%20class%3D%5C%22fa-stack%20%5C%22%20style%3D%5C%22font-size%3A%2012pt%5C%22%20%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cspan%20class%3D%5C%22fa%20fa-circle-o%20fa-stack-2x%5C%22%20style%3D%5C%22color%20%3A%20red%5C%22%5Cu003e%5Cu003c/span%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cstrong%20class%3D%5C%22fa-stack-1x%5C%22%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%201%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/strong%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/span%5Cu003e%22%2C%20%22iconAnchor%22%3A%20%5B12%2C%2040%5D%2C%20%22iconSize%22%3A%20%5B150%2C%2036%5D%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20marker_65e7fae5e33b4fce964aeed2ae952d2e.setIcon%28div_icon_a0772394217d4a2180c3596848035573%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20marker_c99bd2d766fc4c9981ba4bc3dd6a7226%20%3D%20L.marker%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B43.6676717%2C%20-79.3961722%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%29.addTo%28map_c1bddb3b59fd4c87b379bca1fbd4d313%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20div_icon_f81978c5a8c440229f88d8a6aa84f72b%20%3D%20L.divIcon%28%7B%22className%22%3A%20%22empty%22%2C%20%22html%22%3A%20%22%5Cu003cspan%20class%3D%5C%22fa-stack%20%5C%22%20style%3D%5C%22font-size%3A%2012pt%5C%22%20%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cspan%20class%3D%5C%22fa%20fa-circle-o%20fa-stack-2x%5C%22%20style%3D%5C%22color%20%3A%20red%5C%22%5Cu003e%5Cu003c/span%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cstrong%20class%3D%5C%22fa-stack-1x%5C%22%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%202%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/strong%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/span%5Cu003e%22%2C%20%22iconAnchor%22%3A%20%5B12%2C%2040%5D%2C%20%22iconSize%22%3A%20%5B150%2C%2036%5D%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20marker_c99bd2d766fc4c9981ba4bc3dd6a7226.setIcon%28div_icon_f81978c5a8c440229f88d8a6aa84f72b%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20marker_e35750a2526e40e3ae0c4f96900da5cc%20%3D%20L.marker%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B43.6536066%2C%20-79.39251229999999%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%29.addTo%28map_c1bddb3b59fd4c87b379bca1fbd4d313%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20div_icon_0fe8f35a8a4a44fbbceca76a0ee35dcd%20%3D%20L.divIcon%28%7B%22className%22%3A%20%22empty%22%2C%20%22html%22%3A%20%22%5Cu003cspan%20class%3D%5C%22fa-stack%20%5C%22%20style%3D%5C%22font-size%3A%2012pt%5C%22%20%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cspan%20class%3D%5C%22fa%20fa-circle-o%20fa-stack-2x%5C%22%20style%3D%5C%22color%20%3A%20red%5C%22%5Cu003e%5Cu003c/span%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cstrong%20class%3D%5C%22fa-stack-1x%5C%22%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%203%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/strong%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/span%5Cu003e%22%2C%20%22iconAnchor%22%3A%20%5B12%2C%2040%5D%2C%20%22iconSize%22%3A%20%5B150%2C%2036%5D%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20marker_e35750a2526e40e3ae0c4f96900da5cc.setIcon%28div_icon_0fe8f35a8a4a44fbbceca76a0ee35dcd%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20marker_e2b844ded5464de6b8b51c1cf4308bf4%20%3D%20L.marker%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B43.6864006%2C%20-79.3602927%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%29.addTo%28map_c1bddb3b59fd4c87b379bca1fbd4d313%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20div_icon_deb2dd707c284e759247984f65fa313c%20%3D%20L.divIcon%28%7B%22className%22%3A%20%22empty%22%2C%20%22html%22%3A%20%22%5Cu003cspan%20class%3D%5C%22fa-stack%20%5C%22%20style%3D%5C%22font-size%3A%2012pt%5C%22%20%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cspan%20class%3D%5C%22fa%20fa-circle-o%20fa-stack-2x%5C%22%20style%3D%5C%22color%20%3A%20red%5C%22%5Cu003e%5Cu003c/span%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cstrong%20class%3D%5C%22fa-stack-1x%5C%22%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%204%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/strong%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/span%5Cu003e%22%2C%20%22iconAnchor%22%3A%20%5B12%2C%2040%5D%2C%20%22iconSize%22%3A%20%5B150%2C%2036%5D%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20marker_e2b844ded5464de6b8b51c1cf4308bf4.setIcon%28div_icon_deb2dd707c284e759247984f65fa313c%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20marker_c6995587dc644818b0fc1bf25c679232%20%3D%20L.marker%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B43.6596%2C%20-79.3969%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%29.addTo%28map_c1bddb3b59fd4c87b379bca1fbd4d313%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20div_icon_596f985e74b1475abc21f5a7a99e89bf%20%3D%20L.divIcon%28%7B%22className%22%3A%20%22empty%22%2C%20%22html%22%3A%20%22%5Cu003cspan%20class%3D%5C%22fa-stack%20%5C%22%20style%3D%5C%22font-size%3A%2012pt%5C%22%20%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cspan%20class%3D%5C%22fa%20fa-circle-o%20fa-stack-2x%5C%22%20style%3D%5C%22color%20%3A%20red%5C%22%5Cu003e%5Cu003c/span%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cstrong%20class%3D%5C%22fa-stack-1x%5C%22%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%200%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/strong%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/span%5Cu003e%22%2C%20%22iconAnchor%22%3A%20%5B12%2C%2040%5D%2C%20%22iconSize%22%3A%20%5B150%2C%2036%5D%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20marker_c6995587dc644818b0fc1bf25c679232.setIcon%28div_icon_596f985e74b1475abc21f5a7a99e89bf%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20ant_path_cea15d8541a247ad8666b212aeb7cab3%20%3D%20L.polyline.antPath%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B%5B%5B43.65966%2C%20-79.3966%5D%2C%20%5B43.664076%2C%20-79.39844%5D%2C%20%5B43.664436%2C%20-79.396904%5D%2C%20%5B43.666077%2C%20-79.397584%5D%2C%20%5B43.666222%2C%20-79.396866%5D%2C%20%5B43.665496%2C%20-79.397128%5D%2C%20%5B43.665496%2C%20-79.397128%5D%2C%20%5B43.666222%2C%20-79.396866%5D%2C%20%5B43.666866%2C%20-79.395381%5D%2C%20%5B43.667173%2C%20-79.395531%5D%2C%20%5B43.667463%2C%20-79.395991%5D%2C%20%5B43.667463%2C%20-79.395991%5D%2C%20%5B43.667173%2C%20-79.395531%5D%2C%20%5B43.666866%2C%20-79.395381%5D%2C%20%5B43.666077%2C%20-79.397584%5D%2C%20%5B43.664436%2C%20-79.396904%5D%2C%20%5B43.665044%2C%20-79.393909%5D%2C%20%5B43.660676%2C%20-79.391235%5D%2C%20%5B43.659826%2C%20-79.390591%5D%2C%20%5B43.659199%2C%20-79.393501%5D%2C%20%5B43.654307%2C%20-79.391431%5D%2C%20%5B43.654053%2C%20-79.392688%5D%2C%20%5B43.654053%2C%20-79.392688%5D%2C%20%5B43.654307%2C%20-79.391431%5D%2C%20%5B43.655799%2C%20-79.392053%5D%2C%20%5B43.657314%2C%20-79.384368%5D%2C%20%5B43.664377%2C%20-79.387155%5D%2C%20%5B43.668176%2C%20-79.369549%5D%2C%20%5B43.671963%2C%20-79.370843%5D%2C%20%5B43.675792%2C%20-79.361068%5D%2C%20%5B43.676219%2C%20-79.35884%5D%2C%20%5B43.683941%2C%20-79.356955%5D%2C%20%5B43.68684%2C%20-79.360324%5D%2C%20%5B43.686376%2C%20-79.360103%5D%2C%20%5B43.686376%2C%20-79.360103%5D%2C%20%5B43.68684%2C%20-79.360324%5D%2C%20%5B43.683941%2C%20-79.356955%5D%2C%20%5B43.676219%2C%20-79.35884%5D%2C%20%5B43.675792%2C%20-79.361068%5D%2C%20%5B43.671963%2C%20-79.370843%5D%2C%20%5B43.668176%2C%20-79.369549%5D%2C%20%5B43.664377%2C%20-79.387155%5D%2C%20%5B43.660808%2C%20-79.385848%5D%2C%20%5B43.658696%2C%20-79.395985%5D%2C%20%5B43.65966%2C%20-79.3966%5D%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%22bubblingMouseEvents%22%3A%20true%2C%20%22color%22%3A%20%22red%22%2C%20%22dashArray%22%3A%20%5B1%2C%2010%5D%2C%20%22dashOffset%22%3A%20null%2C%20%22delay%22%3A%201000%2C%20%22fill%22%3A%20false%2C%20%22fillColor%22%3A%20%22red%22%2C%20%22fillOpacity%22%3A%200.2%2C%20%22fillRule%22%3A%20%22evenodd%22%2C%20%22hardwareAcceleration%22%3A%20false%2C%20%22lineCap%22%3A%20%22round%22%2C%20%22lineJoin%22%3A%20%22round%22%2C%20%22noClip%22%3A%20false%2C%20%22opacity%22%3A%200.5%2C%20%22paused%22%3A%20false%2C%20%22pulseColor%22%3A%20%22%23FFFFFF%22%2C%20%22reverse%22%3A%20false%2C%20%22smoothFactor%22%3A%201.0%2C%20%22stroke%22%3A%20true%2C%20%22weight%22%3A%205%7D%0A%20%20%20%20%20%20%20%20%29.addTo%28map_c1bddb3b59fd4c87b379bca1fbd4d313%29%3B%0A%20%20%20%20%20%20%20%20%0A%3C/script%3E onload="this.contentDocument.open();this.contentDocument.write(    decodeURIComponent(this.getAttribute('data-html')));this.contentDocument.close();" allowfullscreen webkitallowfullscreen mozallowfullscreen></iframe></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">aga</span><span class="o">.</span><span class="n">converge_history</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))),</span><span class="n">data</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Convergence process of AGA&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;iteration&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;pop. score&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The final solution has a score of&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">aga</span><span class="o">.</span><span class="n">global_score</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The final solution has a score of 38.455375000000004
</pre></div>
</div>
<img alt="../../../_images/f27afe470ac1d0a7dee4d7ba2c7b7b2d44f3725473e4bbcbc90973d9dc5a8bc4.png" src="../../../_images/f27afe470ac1d0a7dee4d7ba2c7b7b2d44f3725473e4bbcbc90973d9dc5a8bc4.png" />
</div>
</div>
</section>
</section>
<section id="abc-solution">
<h3>ABC Solution<a class="headerlink" href="#abc-solution" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">abc</span> <span class="o">=</span> <span class="n">AritificalBeeColonySolver</span><span class="p">()</span>
<span class="n">abc</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">sol</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">gaint_tour_decode</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">id_pois_map</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span>  <span class="n">abc</span><span class="o">.</span><span class="n">global_solution</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 1000/1000 [00:04&lt;00:00, 216.50it/s]
</pre></div>
</div>
</div>
</div>
<section id="id2">
<h4>Visualizing Results<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Problem</span><span class="o">.</span><span class="n">draw_tours</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div style="width:100%;"><div style="position:relative;width:100%;height:0;padding-bottom:60%;"><span style="color:#565656">Make this Notebook Trusted to load map: File -> Trust Notebook</span><iframe src="about:blank" style="position:absolute;width:100%;height:100%;left:0;top:0;border:none !important;" data-html=%3C%21DOCTYPE%20html%3E%0A%3Chead%3E%20%20%20%20%0A%20%20%20%20%3Cmeta%20http-equiv%3D%22content-type%22%20content%3D%22text/html%3B%20charset%3DUTF-8%22%20/%3E%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%3Cscript%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20L_NO_TOUCH%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20L_DISABLE_3D%20%3D%20false%3B%0A%20%20%20%20%20%20%20%20%3C/script%3E%0A%20%20%20%20%0A%20%20%20%20%3Cstyle%3Ehtml%2C%20body%20%7Bwidth%3A%20100%25%3Bheight%3A%20100%25%3Bmargin%3A%200%3Bpadding%3A%200%3B%7D%3C/style%3E%0A%20%20%20%20%3Cstyle%3E%23map%20%7Bposition%3Aabsolute%3Btop%3A0%3Bbottom%3A0%3Bright%3A0%3Bleft%3A0%3B%7D%3C/style%3E%0A%20%20%20%20%3Cscript%20src%3D%22https%3A//cdn.jsdelivr.net/npm/leaflet%401.6.0/dist/leaflet.js%22%3E%3C/script%3E%0A%20%20%20%20%3Cscript%20src%3D%22https%3A//code.jquery.com/jquery-1.12.4.min.js%22%3E%3C/script%3E%0A%20%20%20%20%3Cscript%20src%3D%22https%3A//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js%22%3E%3C/script%3E%0A%20%20%20%20%3Cscript%20src%3D%22https%3A//cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js%22%3E%3C/script%3E%0A%20%20%20%20%3Clink%20rel%3D%22stylesheet%22%20href%3D%22https%3A//cdn.jsdelivr.net/npm/leaflet%401.6.0/dist/leaflet.css%22/%3E%0A%20%20%20%20%3Clink%20rel%3D%22stylesheet%22%20href%3D%22https%3A//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css%22/%3E%0A%20%20%20%20%3Clink%20rel%3D%22stylesheet%22%20href%3D%22https%3A//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css%22/%3E%0A%20%20%20%20%3Clink%20rel%3D%22stylesheet%22%20href%3D%22https%3A//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css%22/%3E%0A%20%20%20%20%3Clink%20rel%3D%22stylesheet%22%20href%3D%22https%3A//cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css%22/%3E%0A%20%20%20%20%3Clink%20rel%3D%22stylesheet%22%20href%3D%22https%3A//cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css%22/%3E%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cmeta%20name%3D%22viewport%22%20content%3D%22width%3Ddevice-width%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20initial-scale%3D1.0%2C%20maximum-scale%3D1.0%2C%20user-scalable%3Dno%22%20/%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cstyle%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23map_de972f999e2b46c6bcc5aecd125f129e%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20position%3A%20relative%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20width%3A%20100.0%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20height%3A%20100.0%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20left%3A%200.0%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20top%3A%200.0%25%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%3C/style%3E%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%3Cscript%20src%3D%22https%3A//cdn.jsdelivr.net/npm/leaflet-ant-path%401.1.2/dist/leaflet-ant-path.min.js%22%3E%3C/script%3E%0A%3C/head%3E%0A%3Cbody%3E%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cdiv%20class%3D%22folium-map%22%20id%3D%22map_de972f999e2b46c6bcc5aecd125f129e%22%20%3E%3C/div%3E%0A%20%20%20%20%20%20%20%20%0A%3C/body%3E%0A%3Cscript%3E%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20map_de972f999e2b46c6bcc5aecd125f129e%20%3D%20L.map%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22map_de972f999e2b46c6bcc5aecd125f129e%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20center%3A%20%5B0%2C%200%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20crs%3A%20L.CRS.EPSG3857%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20zoom%3A%201%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20zoomControl%3A%20true%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20preferCanvas%3A%20false%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%29%3B%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%0A%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20tile_layer_4fcd7a358cef44b781d8ad1bb0ce340d%20%3D%20L.tileLayer%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22https%3A//%7Bs%7D.tile.openstreetmap.org/%7Bz%7D/%7Bx%7D/%7By%7D.png%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%22attribution%22%3A%20%22Data%20by%20%5Cu0026copy%3B%20%5Cu003ca%20href%3D%5C%22http%3A//openstreetmap.org%5C%22%5Cu003eOpenStreetMap%5Cu003c/a%5Cu003e%2C%20under%20%5Cu003ca%20href%3D%5C%22http%3A//www.openstreetmap.org/copyright%5C%22%5Cu003eODbL%5Cu003c/a%5Cu003e.%22%2C%20%22detectRetina%22%3A%20false%2C%20%22maxNativeZoom%22%3A%2018%2C%20%22maxZoom%22%3A%2018%2C%20%22minZoom%22%3A%200%2C%20%22noWrap%22%3A%20false%2C%20%22opacity%22%3A%201%2C%20%22subdomains%22%3A%20%22abc%22%2C%20%22tms%22%3A%20false%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%29.addTo%28map_de972f999e2b46c6bcc5aecd125f129e%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20map_de972f999e2b46c6bcc5aecd125f129e.fitBounds%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B%5B%5B43.6527542%2C%20-79.36498929999999%5D%2C%20%5B43.6596%2C%20-79.3969%5D%5D%2C%20%5B%5B43.7480943%2C%20-79.192493%5D%2C%20%5B43.7480943%2C%20-79.192493%5D%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20marker_ca6226b9092a4810aa10d76e745f9410%20%3D%20L.marker%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B43.6618354%2C%20-79.3116652%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%29.addTo%28map_de972f999e2b46c6bcc5aecd125f129e%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20div_icon_7a70e1c686254481b7c4d38bee29e789%20%3D%20L.divIcon%28%7B%22className%22%3A%20%22empty%22%2C%20%22html%22%3A%20%22%5Cu003cspan%20class%3D%5C%22fa-stack%20%5C%22%20style%3D%5C%22font-size%3A%2012pt%5C%22%20%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cspan%20class%3D%5C%22fa%20fa-circle-o%20fa-stack-2x%5C%22%20style%3D%5C%22color%20%3A%20blue%5C%22%5Cu003e%5Cu003c/span%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cstrong%20class%3D%5C%22fa-stack-1x%5C%22%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%201%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/strong%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/span%5Cu003e%22%2C%20%22iconAnchor%22%3A%20%5B12%2C%2040%5D%2C%20%22iconSize%22%3A%20%5B150%2C%2036%5D%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20marker_ca6226b9092a4810aa10d76e745f9410.setIcon%28div_icon_7a70e1c686254481b7c4d38bee29e789%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20marker_75b5b814ecaf4651b52abee1fd24c27a%20%3D%20L.marker%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B43.6631609%2C%20-79.3957289%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%29.addTo%28map_de972f999e2b46c6bcc5aecd125f129e%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20div_icon_70bceee457654599becb79a375b7212f%20%3D%20L.divIcon%28%7B%22className%22%3A%20%22empty%22%2C%20%22html%22%3A%20%22%5Cu003cspan%20class%3D%5C%22fa-stack%20%5C%22%20style%3D%5C%22font-size%3A%2012pt%5C%22%20%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cspan%20class%3D%5C%22fa%20fa-circle-o%20fa-stack-2x%5C%22%20style%3D%5C%22color%20%3A%20blue%5C%22%5Cu003e%5Cu003c/span%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cstrong%20class%3D%5C%22fa-stack-1x%5C%22%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%202%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/strong%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/span%5Cu003e%22%2C%20%22iconAnchor%22%3A%20%5B12%2C%2040%5D%2C%20%22iconSize%22%3A%20%5B150%2C%2036%5D%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20marker_75b5b814ecaf4651b52abee1fd24c27a.setIcon%28div_icon_70bceee457654599becb79a375b7212f%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20marker_4de1b3ce89764dca947bc3b518ebaa92%20%3D%20L.marker%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B43.73345339999999%2C%20-79.3598792%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%29.addTo%28map_de972f999e2b46c6bcc5aecd125f129e%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20div_icon_3fbb6bd3740f470b8753c6dfd80dbe43%20%3D%20L.divIcon%28%7B%22className%22%3A%20%22empty%22%2C%20%22html%22%3A%20%22%5Cu003cspan%20class%3D%5C%22fa-stack%20%5C%22%20style%3D%5C%22font-size%3A%2012pt%5C%22%20%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cspan%20class%3D%5C%22fa%20fa-circle-o%20fa-stack-2x%5C%22%20style%3D%5C%22color%20%3A%20blue%5C%22%5Cu003e%5Cu003c/span%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cstrong%20class%3D%5C%22fa-stack-1x%5C%22%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%203%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/strong%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/span%5Cu003e%22%2C%20%22iconAnchor%22%3A%20%5B12%2C%2040%5D%2C%20%22iconSize%22%3A%20%5B150%2C%2036%5D%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20marker_4de1b3ce89764dca947bc3b518ebaa92.setIcon%28div_icon_3fbb6bd3740f470b8753c6dfd80dbe43%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20marker_2843b78b0d2542ff92956197e24752fd%20%3D%20L.marker%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B43.6596%2C%20-79.3969%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%29.addTo%28map_de972f999e2b46c6bcc5aecd125f129e%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20div_icon_e335c3e4b4c94999bb2a1f66a2c26d84%20%3D%20L.divIcon%28%7B%22className%22%3A%20%22empty%22%2C%20%22html%22%3A%20%22%5Cu003cspan%20class%3D%5C%22fa-stack%20%5C%22%20style%3D%5C%22font-size%3A%2012pt%5C%22%20%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cspan%20class%3D%5C%22fa%20fa-circle-o%20fa-stack-2x%5C%22%20style%3D%5C%22color%20%3A%20blue%5C%22%5Cu003e%5Cu003c/span%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cstrong%20class%3D%5C%22fa-stack-1x%5C%22%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%200%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/strong%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/span%5Cu003e%22%2C%20%22iconAnchor%22%3A%20%5B12%2C%2040%5D%2C%20%22iconSize%22%3A%20%5B150%2C%2036%5D%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20marker_2843b78b0d2542ff92956197e24752fd.setIcon%28div_icon_e335c3e4b4c94999bb2a1f66a2c26d84%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20ant_path_0c32f82f836d4b958e6c2077c17392c9%20%3D%20L.polyline.antPath%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B%5B%5B43.65966%2C%20-79.3966%5D%2C%20%5B43.658696%2C%20-79.395985%5D%2C%20%5B43.659199%2C%20-79.393501%5D%2C%20%5B43.655799%2C%20-79.392053%5D%2C%20%5B43.656982%2C%20-79.385832%5D%2C%20%5B43.655421%2C%20-79.385196%5D%2C%20%5B43.656297%2C%20-79.37958%5D%2C%20%5B43.650691%2C%20-79.377225%5D%2C%20%5B43.651556%2C%20-79.372351%5D%2C%20%5B43.649465%2C%20-79.371454%5D%2C%20%5B43.645527%2C%20-79.369806%5D%2C%20%5B43.662228%2C%20-79.314778%5D%2C%20%5B43.661556%2C%20-79.312421%5D%2C%20%5B43.661556%2C%20-79.312421%5D%2C%20%5B43.662228%2C%20-79.314778%5D%2C%20%5B43.659233%2C%20-79.328325%5D%2C%20%5B43.660558%2C%20-79.329044%5D%2C%20%5B43.660327%2C%20-79.330782%5D%2C%20%5B43.655714%2C%20-79.355079%5D%2C%20%5B43.654563%2C%20-79.364001%5D%2C%20%5B43.668176%2C%20-79.369549%5D%2C%20%5B43.663027%2C%20-79.393493%5D%2C%20%5B43.662285%2C%20-79.39575%5D%2C%20%5B43.662236%2C%20-79.396263%5D%2C%20%5B43.662384%2C%20-79.39652%5D%2C%20%5B43.663033%2C%20-79.396095%5D%2C%20%5B43.663118%2C%20-79.395711%5D%2C%20%5B43.663118%2C%20-79.395711%5D%2C%20%5B43.663033%2C%20-79.396095%5D%2C%20%5B43.663258%2C%20-79.396201%5D%2C%20%5B43.66362%2C%20-79.395255%5D%2C%20%5B43.664694%2C%20-79.395673%5D%2C%20%5B43.665044%2C%20-79.393909%5D%2C%20%5B43.664214%2C%20-79.393622%5D%2C%20%5B43.663141%2C%20-79.392768%5D%2C%20%5B43.668176%2C%20-79.369549%5D%2C%20%5B43.671963%2C%20-79.370843%5D%2C%20%5B43.67601%2C%20-79.359931%5D%2C%20%5B43.673198%2C%20-79.360262%5D%2C%20%5B43.736769%2C%20-79.331963%5D%2C%20%5B43.739691%2C%20-79.330841%5D%2C%20%5B43.734535%2C%20-79.35722%5D%2C%20%5B43.734161%2C%20-79.357197%5D%2C%20%5B43.733514%2C%20-79.358502%5D%2C%20%5B43.733514%2C%20-79.358502%5D%2C%20%5B43.734064%2C%20-79.357306%5D%2C%20%5B43.734535%2C%20-79.35722%5D%2C%20%5B43.738991%2C%20-79.334657%5D%2C%20%5B43.735816%2C%20-79.331997%5D%2C%20%5B43.684115%2C%20-79.36163%5D%2C%20%5B43.682736%2C%20-79.36342%5D%2C%20%5B43.678402%2C%20-79.36857%5D%2C%20%5B43.674501%2C%20-79.368553%5D%2C%20%5B43.673811%2C%20-79.368146%5D%2C%20%5B43.671963%2C%20-79.370843%5D%2C%20%5B43.668176%2C%20-79.369549%5D%2C%20%5B43.664377%2C%20-79.387155%5D%2C%20%5B43.660808%2C%20-79.385848%5D%2C%20%5B43.658696%2C%20-79.395985%5D%2C%20%5B43.65966%2C%20-79.3966%5D%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%22bubblingMouseEvents%22%3A%20true%2C%20%22color%22%3A%20%22blue%22%2C%20%22dashArray%22%3A%20%5B1%2C%2010%5D%2C%20%22dashOffset%22%3A%20null%2C%20%22delay%22%3A%201000%2C%20%22fill%22%3A%20false%2C%20%22fillColor%22%3A%20%22blue%22%2C%20%22fillOpacity%22%3A%200.2%2C%20%22fillRule%22%3A%20%22evenodd%22%2C%20%22hardwareAcceleration%22%3A%20false%2C%20%22lineCap%22%3A%20%22round%22%2C%20%22lineJoin%22%3A%20%22round%22%2C%20%22noClip%22%3A%20false%2C%20%22opacity%22%3A%200.5%2C%20%22paused%22%3A%20false%2C%20%22pulseColor%22%3A%20%22%23FFFFFF%22%2C%20%22reverse%22%3A%20false%2C%20%22smoothFactor%22%3A%201.0%2C%20%22stroke%22%3A%20true%2C%20%22weight%22%3A%205%7D%0A%20%20%20%20%20%20%20%20%29.addTo%28map_de972f999e2b46c6bcc5aecd125f129e%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20marker_0eb46e6e98f54db48b9b21488fcc3d7c%20%3D%20L.marker%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B43.6560524%2C%20-79.3846762%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%29.addTo%28map_de972f999e2b46c6bcc5aecd125f129e%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20div_icon_3e3b96e34627418ba519cd436be90739%20%3D%20L.divIcon%28%7B%22className%22%3A%20%22empty%22%2C%20%22html%22%3A%20%22%5Cu003cspan%20class%3D%5C%22fa-stack%20%5C%22%20style%3D%5C%22font-size%3A%2012pt%5C%22%20%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cspan%20class%3D%5C%22fa%20fa-circle-o%20fa-stack-2x%5C%22%20style%3D%5C%22color%20%3A%20red%5C%22%5Cu003e%5Cu003c/span%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cstrong%20class%3D%5C%22fa-stack-1x%5C%22%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%201%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/strong%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/span%5Cu003e%22%2C%20%22iconAnchor%22%3A%20%5B12%2C%2040%5D%2C%20%22iconSize%22%3A%20%5B150%2C%2036%5D%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20marker_0eb46e6e98f54db48b9b21488fcc3d7c.setIcon%28div_icon_3e3b96e34627418ba519cd436be90739%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20marker_ef9d35ef84f24e21884a9422e3476f25%20%3D%20L.marker%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B43.6527542%2C%20-79.36498929999999%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%29.addTo%28map_de972f999e2b46c6bcc5aecd125f129e%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20div_icon_6d0e3b66438042eca3466fa20ebac09d%20%3D%20L.divIcon%28%7B%22className%22%3A%20%22empty%22%2C%20%22html%22%3A%20%22%5Cu003cspan%20class%3D%5C%22fa-stack%20%5C%22%20style%3D%5C%22font-size%3A%2012pt%5C%22%20%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cspan%20class%3D%5C%22fa%20fa-circle-o%20fa-stack-2x%5C%22%20style%3D%5C%22color%20%3A%20red%5C%22%5Cu003e%5Cu003c/span%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cstrong%20class%3D%5C%22fa-stack-1x%5C%22%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%202%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/strong%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/span%5Cu003e%22%2C%20%22iconAnchor%22%3A%20%5B12%2C%2040%5D%2C%20%22iconSize%22%3A%20%5B150%2C%2036%5D%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20marker_ef9d35ef84f24e21884a9422e3476f25.setIcon%28div_icon_6d0e3b66438042eca3466fa20ebac09d%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20marker_ae3ea8748678498f8347f22a752a9cc5%20%3D%20L.marker%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B43.7480943%2C%20-79.192493%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%29.addTo%28map_de972f999e2b46c6bcc5aecd125f129e%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20div_icon_85beed726c384cab811e304c5acb2271%20%3D%20L.divIcon%28%7B%22className%22%3A%20%22empty%22%2C%20%22html%22%3A%20%22%5Cu003cspan%20class%3D%5C%22fa-stack%20%5C%22%20style%3D%5C%22font-size%3A%2012pt%5C%22%20%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cspan%20class%3D%5C%22fa%20fa-circle-o%20fa-stack-2x%5C%22%20style%3D%5C%22color%20%3A%20red%5C%22%5Cu003e%5Cu003c/span%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cstrong%20class%3D%5C%22fa-stack-1x%5C%22%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%203%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/strong%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/span%5Cu003e%22%2C%20%22iconAnchor%22%3A%20%5B12%2C%2040%5D%2C%20%22iconSize%22%3A%20%5B150%2C%2036%5D%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20marker_ae3ea8748678498f8347f22a752a9cc5.setIcon%28div_icon_85beed726c384cab811e304c5acb2271%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20marker_998172d3a065416da12443ce7d9d81c0%20%3D%20L.marker%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B43.6576945%2C%20-79.37938299999999%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%29.addTo%28map_de972f999e2b46c6bcc5aecd125f129e%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20div_icon_4d4c942b915546ce844f0ba4f68dd907%20%3D%20L.divIcon%28%7B%22className%22%3A%20%22empty%22%2C%20%22html%22%3A%20%22%5Cu003cspan%20class%3D%5C%22fa-stack%20%5C%22%20style%3D%5C%22font-size%3A%2012pt%5C%22%20%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cspan%20class%3D%5C%22fa%20fa-circle-o%20fa-stack-2x%5C%22%20style%3D%5C%22color%20%3A%20red%5C%22%5Cu003e%5Cu003c/span%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cstrong%20class%3D%5C%22fa-stack-1x%5C%22%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%204%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/strong%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/span%5Cu003e%22%2C%20%22iconAnchor%22%3A%20%5B12%2C%2040%5D%2C%20%22iconSize%22%3A%20%5B150%2C%2036%5D%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20marker_998172d3a065416da12443ce7d9d81c0.setIcon%28div_icon_4d4c942b915546ce844f0ba4f68dd907%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20marker_f2c302daf7bf4b11a43ec0e7b01ece99%20%3D%20L.marker%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B43.6596%2C%20-79.3969%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%7D%0A%20%20%20%20%20%20%20%20%20%20%20%20%29.addTo%28map_de972f999e2b46c6bcc5aecd125f129e%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20var%20div_icon_dd7bb1365dd047e1b6914eafa8ea2d8d%20%3D%20L.divIcon%28%7B%22className%22%3A%20%22empty%22%2C%20%22html%22%3A%20%22%5Cu003cspan%20class%3D%5C%22fa-stack%20%5C%22%20style%3D%5C%22font-size%3A%2012pt%5C%22%20%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cspan%20class%3D%5C%22fa%20fa-circle-o%20fa-stack-2x%5C%22%20style%3D%5C%22color%20%3A%20red%5C%22%5Cu003e%5Cu003c/span%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003cstrong%20class%3D%5C%22fa-stack-1x%5C%22%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%200%20%20%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/strong%5Cu003e%5Cn%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Cu003c/span%5Cu003e%22%2C%20%22iconAnchor%22%3A%20%5B12%2C%2040%5D%2C%20%22iconSize%22%3A%20%5B150%2C%2036%5D%7D%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20marker_f2c302daf7bf4b11a43ec0e7b01ece99.setIcon%28div_icon_dd7bb1365dd047e1b6914eafa8ea2d8d%29%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%0A%20%20%20%20%20%20%20%20%20%20%20%20ant_path_d91ecbd32cac4027be3ac4a022f99102%20%3D%20L.polyline.antPath%28%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5B%5B%5B43.65966%2C%20-79.3966%5D%2C%20%5B43.658696%2C%20-79.395985%5D%2C%20%5B43.659199%2C%20-79.393501%5D%2C%20%5B43.655799%2C%20-79.392053%5D%2C%20%5B43.657314%2C%20-79.384368%5D%2C%20%5B43.656081%2C%20-79.383862%5D%2C%20%5B43.655936%2C%20-79.384522%5D%2C%20%5B43.655936%2C%20-79.384522%5D%2C%20%5B43.656081%2C%20-79.383862%5D%2C%20%5B43.655734%2C%20-79.383734%5D%2C%20%5B43.656297%2C%20-79.37958%5D%2C%20%5B43.650691%2C%20-79.377225%5D%2C%20%5B43.652893%2C%20-79.365228%5D%2C%20%5B43.652718%2C%20-79.365153%5D%2C%20%5B43.652718%2C%20-79.365153%5D%2C%20%5B43.652893%2C%20-79.365228%5D%2C%20%5B43.656064%2C%20-79.354012%5D%2C%20%5B43.66723%2C%20-79.312592%5D%2C%20%5B43.749553%2C%20-79.205967%5D%2C%20%5B43.749007%2C%20-79.192468%5D%2C%20%5B43.748603%2C%20-79.192296%5D%2C%20%5B43.748515%2C%20-79.192679%5D%2C%20%5B43.748515%2C%20-79.192679%5D%2C%20%5B43.748353%2C%20-79.193378%5D%2C%20%5B43.748724%2C%20-79.193763%5D%2C%20%5B43.74967%2C%20-79.205863%5D%2C%20%5B43.702504%2C%20-79.254222%5D%2C%20%5B43.66723%2C%20-79.312592%5D%2C%20%5B43.655714%2C%20-79.355079%5D%2C%20%5B43.654563%2C%20-79.364001%5D%2C%20%5B43.656951%2C%20-79.364995%5D%2C%20%5B43.654581%2C%20-79.377587%5D%2C%20%5B43.65779%2C%20-79.378928%5D%2C%20%5B43.65779%2C%20-79.378928%5D%2C%20%5B43.658206%2C%20-79.377836%5D%2C%20%5B43.65986%2C%20-79.378517%5D%2C%20%5B43.65851%2C%20-79.384862%5D%2C%20%5B43.660808%2C%20-79.385848%5D%2C%20%5B43.658696%2C%20-79.395985%5D%2C%20%5B43.65966%2C%20-79.3966%5D%5D%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%7B%22bubblingMouseEvents%22%3A%20true%2C%20%22color%22%3A%20%22red%22%2C%20%22dashArray%22%3A%20%5B1%2C%2010%5D%2C%20%22dashOffset%22%3A%20null%2C%20%22delay%22%3A%201000%2C%20%22fill%22%3A%20false%2C%20%22fillColor%22%3A%20%22red%22%2C%20%22fillOpacity%22%3A%200.2%2C%20%22fillRule%22%3A%20%22evenodd%22%2C%20%22hardwareAcceleration%22%3A%20false%2C%20%22lineCap%22%3A%20%22round%22%2C%20%22lineJoin%22%3A%20%22round%22%2C%20%22noClip%22%3A%20false%2C%20%22opacity%22%3A%200.5%2C%20%22paused%22%3A%20false%2C%20%22pulseColor%22%3A%20%22%23FFFFFF%22%2C%20%22reverse%22%3A%20false%2C%20%22smoothFactor%22%3A%201.0%2C%20%22stroke%22%3A%20true%2C%20%22weight%22%3A%205%7D%0A%20%20%20%20%20%20%20%20%29.addTo%28map_de972f999e2b46c6bcc5aecd125f129e%29%3B%0A%20%20%20%20%20%20%20%20%0A%3C/script%3E onload="this.contentDocument.open();this.contentDocument.write(    decodeURIComponent(this.getAttribute('data-html')));this.contentDocument.close();" allowfullscreen webkitallowfullscreen mozallowfullscreen></iframe></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">abc</span><span class="o">.</span><span class="n">converge_history</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))),</span><span class="n">data</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Convergence process of abc&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;iteration&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;pop. score&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The final solution has a score of&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">global_score</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The final solution has a score of 37.176791
</pre></div>
</div>
<img alt="../../../_images/c8ba36af9f0e26a8a9188fa582eb6d06c7c9c493aa08763b273d8b69157a4613.png" src="../../../_images/c8ba36af9f0e26a8a9188fa582eb6d06c7c9c493aa08763b273d8b69157a4613.png" />
</div>
</div>
</section>
</section>
</section>
<section id="comparative-analysis">
<h2>Comparative Analysis<a class="headerlink" href="#comparative-analysis" title="Permalink to this heading">#</a></h2>
<p>We can also compare the results across the different approaches in terms of wall time, cpu time, score, and optimality.</p>
<p>This can be done by first storing the runtime results in experiment files, and plotting the results side by side.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Experiment</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">problem</span><span class="p">,</span> <span class="n">solver</span><span class="p">,</span> <span class="n">num_run</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">cold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">population_size</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">problem</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimal_score</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">number_of_tour</span> <span class="o">*</span> <span class="mf">5.0</span> <span class="o">*</span> <span class="mf">4.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_cold</span> <span class="o">=</span> <span class="n">cold</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">solver</span> <span class="o">=</span> <span class="n">solver</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">problem</span> <span class="o">=</span> <span class="n">problem</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_run</span> <span class="o">=</span> <span class="n">num_run</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">population_size</span> <span class="o">=</span> <span class="n">population_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;wall_time&quot;</span><span class="p">:[],</span>
            <span class="s2">&quot;cpu_time&quot;</span><span class="p">:[],</span>
            <span class="s2">&quot;score&quot;</span><span class="p">:[],</span>
            <span class="s2">&quot;optimality&quot;</span><span class="p">:[],</span>
            <span class="s2">&quot;num_iteration&quot;</span><span class="p">:[],</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">score_histories</span> <span class="o">=</span> <span class="p">[]</span>
        
    <span class="k">def</span> <span class="nf">load_experiment_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optimal_score</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;optimal_score&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_cold</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;start_cold&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num_run</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;num_run&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">population_size</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;population_size&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;result&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">score_histories</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&quot;score_histories&quot;</span><span class="p">]</span>
        
    <span class="k">def</span> <span class="nf">store_experiment_results</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">experiment_result</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;optimal_score&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimal_score</span><span class="p">,</span>
            <span class="s2">&quot;start_cold&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_cold</span><span class="p">,</span>
            <span class="s2">&quot;solver&quot;</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">solver</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
            <span class="s2">&quot;soft_constraint&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">use_soft_constraint</span><span class="p">,</span>
            <span class="s2">&quot;alpha&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">alpha</span><span class="p">,</span>
            <span class="s2">&quot;number_of_tour&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">number_of_tour</span><span class="p">,</span>
            <span class="s2">&quot;num_run&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_run</span><span class="p">,</span>
            <span class="s2">&quot;population_size&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">population_size</span><span class="p">,</span>
            <span class="s2">&quot;result&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="p">,</span>
            <span class="s2">&quot;score_histories&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">score_histories</span>
        <span class="p">}</span>

        <span class="n">file_name</span> <span class="o">=</span> <span class="s2">&quot;experiment/</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">.json&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">experiment_result</span><span class="p">[</span><span class="s2">&quot;solver&quot;</span><span class="p">],</span> <span class="n">experiment_result</span><span class="p">[</span><span class="s2">&quot;number_of_tour&quot;</span><span class="p">],</span> <span class="n">experiment_result</span><span class="p">[</span><span class="s2">&quot;population_size&quot;</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">&#39;w+&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">experiment_result</span><span class="p">))</span>
        
    <span class="k">def</span> <span class="nf">warm_up_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">solver</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
            
    <span class="k">def</span> <span class="nf">get_mean_result</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">mean_result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">mean_result</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">round</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mean_result</span>
    
    <span class="k">def</span> <span class="nf">get_max_result</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">mean_result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">mean_result</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mean_result</span>
    
    <span class="k">def</span> <span class="nf">get_min_result</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">mean_result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">mean_result</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mean_result</span>
    
    <span class="k">def</span> <span class="nf">get_mean_global_score_history</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">mean_score</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">history_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">score_histories</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">history_len</span><span class="p">):</span>
            <span class="n">val</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">score_history</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">score_histories</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">+=</span> <span class="n">score_history</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">val</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">score_histories</span><span class="p">)</span>
            <span class="n">mean_score</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mean_score</span>
        
    
    <span class="k">def</span> <span class="nf">plot_global_score_history</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">score_history</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">score_histories</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">score_history</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">plot_mean_global_score_history</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">mean_score</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_mean_global_score_history</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mean_score</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">get_num_iteration_to_pdbk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdbk</span><span class="p">,</span> <span class="n">score_history</span><span class="p">):</span>
        <span class="n">score_cut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimal_score</span> <span class="o">-</span> <span class="n">pdbk</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimal_score</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">score</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">score_history</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;=</span> <span class="n">score_cut</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">i</span>
        <span class="k">return</span> <span class="kc">None</span>
                    
    <span class="k">def</span> <span class="nf">get_mean_num_iteration_to_pdbk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pdbk</span><span class="p">):</span>
        <span class="n">cut_points</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">score_history</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">score_histories</span><span class="p">:</span>
            <span class="n">cut_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_num_iteration_to_pdbk</span><span class="p">(</span><span class="n">pdbk</span><span class="p">,</span> <span class="n">score_history</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cut_point</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">cut_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cut_point</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cut_points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">cut_points</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">cut_points</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_cold</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">warm_up_cache</span><span class="p">()</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_run</span><span class="p">):</span>
            <span class="n">wall_time_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
            <span class="n">cpu_time_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
            <span class="n">num_iteration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solver</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="p">)</span>
            <span class="n">wall_time_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
            <span class="n">cpu_time_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">process_time</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;wall_time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">wall_time_end</span> <span class="o">-</span> <span class="n">wall_time_start</span> <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;cpu_time&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">cpu_time_end</span> <span class="o">-</span> <span class="n">cpu_time_start</span> <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;score&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">solver</span><span class="o">.</span><span class="n">global_score</span> <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;optimality&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimal_score</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">solver</span><span class="o">.</span><span class="n">global_score</span> <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">optimal_score</span> <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="p">[</span><span class="s2">&quot;num_iteration&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">num_iteration</span> <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">score_histories</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">solver</span><span class="o">.</span><span class="n">score_history</span> <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">solver</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_cold</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>       
                <span class="bp">self</span><span class="o">.</span><span class="n">problem</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
            
            
            
            
            
        
        
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_run</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">cold</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">population_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">]</span>
<span class="n">number_of_tours</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="k">for</span> <span class="n">population_size</span> <span class="ow">in</span> <span class="n">population_sizes</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">number_of_tour</span> <span class="ow">in</span> <span class="n">number_of_tours</span><span class="p">:</span>
        <span class="n">experiment</span> <span class="o">=</span> <span class="n">Experiment</span><span class="p">(</span><span class="n">Problem</span><span class="p">(</span><span class="n">use_soft_constraint</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span><span class="n">number_of_tour</span><span class="o">=</span><span class="n">number_of_tour</span><span class="p">),</span> 
                                <span class="n">GeneticAlgorithmSolver</span><span class="p">(</span><span class="n">population_size</span><span class="o">=</span><span class="n">population_size</span><span class="p">),</span> 
                                <span class="n">num_run</span><span class="o">=</span><span class="n">num_run</span><span class="p">,</span> <span class="n">cold</span><span class="o">=</span><span class="n">cold</span><span class="p">,</span> <span class="n">population_size</span><span class="o">=</span><span class="n">population_size</span><span class="p">)</span>
        <span class="n">experiment</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
        <span class="n">experiment</span><span class="o">.</span><span class="n">store_experiment_results</span><span class="p">()</span>

        <span class="n">experiment</span> <span class="o">=</span> <span class="n">Experiment</span><span class="p">(</span><span class="n">Problem</span><span class="p">(</span><span class="n">use_soft_constraint</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span><span class="n">number_of_tour</span><span class="o">=</span><span class="n">number_of_tour</span><span class="p">),</span> 
                                <span class="n">AdaptiveGeneticAlgorithmSolver</span><span class="p">(</span><span class="n">population_size</span><span class="o">=</span><span class="n">population_size</span><span class="p">),</span> 
                                <span class="n">num_run</span><span class="o">=</span><span class="n">num_run</span><span class="p">,</span> <span class="n">cold</span><span class="o">=</span><span class="n">cold</span><span class="p">,</span> <span class="n">population_size</span><span class="o">=</span><span class="n">population_size</span><span class="p">)</span>
        <span class="n">experiment</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
        <span class="n">experiment</span><span class="o">.</span><span class="n">store_experiment_results</span><span class="p">()</span>
        
        <span class="n">experiment</span> <span class="o">=</span> <span class="n">Experiment</span><span class="p">(</span><span class="n">Problem</span><span class="p">(</span><span class="n">use_soft_constraint</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">,</span><span class="n">number_of_tour</span><span class="o">=</span><span class="n">number_of_tour</span><span class="p">),</span> 
                                <span class="n">AritificalBeeColonySolver</span><span class="p">(</span><span class="n">population_size</span><span class="o">=</span><span class="n">population_size</span><span class="p">),</span> 
                                <span class="n">num_run</span><span class="o">=</span><span class="n">num_run</span><span class="p">,</span> <span class="n">cold</span><span class="o">=</span><span class="n">cold</span><span class="p">,</span> <span class="n">population_size</span><span class="o">=</span><span class="n">population_size</span><span class="p">)</span>
        <span class="n">experiment</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
        <span class="n">experiment</span><span class="o">.</span><span class="n">store_experiment_results</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 1000/1000 [00:01&lt;00:00, 896.31it/s]
100%|██████████| 1000/1000 [00:00&lt;00:00, 2080.58it/s]
100%|██████████| 1000/1000 [00:00&lt;00:00, 1967.19it/s]
100%|██████████| 1000/1000 [00:02&lt;00:00, 467.82it/s]
100%|██████████| 1000/1000 [00:01&lt;00:00, 503.97it/s]
100%|██████████| 1000/1000 [00:02&lt;00:00, 468.37it/s]
100%|██████████| 1000/1000 [00:04&lt;00:00, 214.88it/s]
100%|██████████| 1000/1000 [00:04&lt;00:00, 217.94it/s]
100%|██████████| 1000/1000 [00:04&lt;00:00, 217.11it/s]
</pre></div>
</div>
</div>
</div>
<section id="id3">
<h3>Visualizing Results<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">glob</span> <span class="kn">import</span> <span class="n">glob</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">mean_scores</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">path_name</span> <span class="ow">in</span> <span class="n">glob</span><span class="p">(</span><span class="s2">&quot;experiment/*&quot;</span><span class="p">):</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path_name</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">solver</span><span class="p">,</span> <span class="n">num_tour</span><span class="p">,</span> <span class="n">population</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">file_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
    <span class="n">experiment</span> <span class="o">=</span> <span class="n">Experiment</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="n">experiment</span><span class="o">.</span><span class="n">load_experiment_results</span><span class="p">(</span><span class="n">path_name</span><span class="p">)</span>
    

    <span class="n">mean_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">experiment</span><span class="o">.</span><span class="n">get_mean_global_score_history</span><span class="p">())</span>
    <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">solver</span><span class="p">[:</span><span class="o">-</span><span class="mi">6</span><span class="p">],</span> <span class="n">population</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">-</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">solver</span><span class="p">[:</span><span class="o">-</span><span class="mi">6</span><span class="p">],</span> <span class="n">population</span><span class="p">),</span> <span class="s2">&quot;average result:&quot;</span><span class="p">,</span> <span class="n">experiment</span><span class="o">.</span><span class="n">get_mean_result</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Global Best Score found at each Iteration&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">mean_score</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">mean_scores</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mean_score</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AritificalBeeColony-20 average result: {&#39;wall_time&#39;: 4.619, &#39;cpu_time&#39;: 4.629, &#39;score&#39;: 37.16, &#39;optimality&#39;: 0.071, &#39;num_iteration&#39;: 999.0}
AdaptiveGeneticAlgorithm-20 average result: {&#39;wall_time&#39;: 12.456, &#39;cpu_time&#39;: 12.344, &#39;score&#39;: 38.291, &#39;optimality&#39;: 0.043, &#39;num_iteration&#39;: 999.0}
GeneticAlgorithm-20 average result: {&#39;wall_time&#39;: 0.707, &#39;cpu_time&#39;: 0.709, &#39;score&#39;: 38.044, &#39;optimality&#39;: 0.049, &#39;num_iteration&#39;: 999.0}
AdaptiveGeneticAlgorithm-20 average result: {&#39;wall_time&#39;: 2.091, &#39;cpu_time&#39;: 2.096, &#39;score&#39;: 38.533, &#39;optimality&#39;: 0.037, &#39;num_iteration&#39;: 999.0}
AritificalBeeColony-20 average result: {&#39;wall_time&#39;: 28.616, &#39;cpu_time&#39;: 28.161, &#39;score&#39;: 37.454, &#39;optimality&#39;: 0.064, &#39;num_iteration&#39;: 999.0}
GeneticAlgorithm-20 average result: {&#39;wall_time&#39;: 4.132, &#39;cpu_time&#39;: 4.099, &#39;score&#39;: 37.829, &#39;optimality&#39;: 0.054, &#39;num_iteration&#39;: 999.0}
</pre></div>
</div>
<img alt="../../../_images/c09b5028a83f811081d6b8d9aa0438cad78a0553da5dcafb0beedb2760bdcb9c.png" src="../../../_images/c09b5028a83f811081d6b8d9aa0438cad78a0553da5dcafb0beedb2760bdcb9c.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content\PeopleMobilityProblems\trip_itinerary_planning"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../carsharing/CarSharing.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Car-Sharing Service</p>
      </div>
    </a>
    <a class="right-next"
       href="../multicriteriarouting/MultiCriteriaRouting.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Multi-Criteria Routing</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset">Dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-formulation">Problem Formulation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variables">Variables</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#objective">Objective</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#constraints">Constraints</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-object">Data Object</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-class">Problem Class</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ga-solver">GA Solver</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#adaptive-ga-solver">Adaptive GA Solver</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#abc-solver">ABC Solver</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#solving-the-problem">Solving the Problem</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ga-solution">GA Solution</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizing-results">Visualizing Results</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adaptive-ga-solution">Adaptive GA Solution</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Visualizing Results</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abc-solution">ABC Solution</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Visualizing Results</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparative-analysis">Comparative Analysis</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Visualizing Results</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Alaa Khamis and Yinan Wang
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2021, Alaa Khamis and Yinan Wang.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>